{"ast":null,"code":"var _jsxFileName = \"F:\\\\kelany\\\\src\\\\pages\\\\CheckInOut.jsx\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useMemo, useState } from 'react';\nimport { supabase } from '../supabaseClient';\nimport { AuthContext } from '../App.jsx';\nimport { canAccessPage } from '../utils/permissions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction StatusBadge({\n  status\n}) {\n  const map = {\n    pending: {\n      text: 'قيد الانتظار',\n      cls: 'bg-yellow-100 text-yellow-800'\n    },\n    confirmed: {\n      text: 'مؤكد',\n      cls: 'bg-green-100 text-green-800'\n    },\n    checked_in: {\n      text: 'تم الدخول',\n      cls: 'bg-blue-100 text-blue-800'\n    },\n    checked_out: {\n      text: 'تم الخروج',\n      cls: 'bg-gray-100 text-gray-800'\n    },\n    cancelled: {\n      text: 'ملغي',\n      cls: 'bg-red-100 text-red-800'\n    },\n    no_show: {\n      text: 'لم يحضر',\n      cls: 'bg-orange-100 text-orange-800'\n    }\n  };\n  const v = map[status] || {\n    text: status,\n    cls: 'bg-slate-100 text-slate-700'\n  };\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    className: `px-2 py-0.5 rounded text-xs font-medium ${v.cls}`,\n    children: v.text\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 16,\n    columnNumber: 10\n  }, this);\n}\n_c = StatusBadge;\nfunction CheckInOutCard({\n  res,\n  type,\n  onCheckIn,\n  onCheckOut\n}) {\n  var _res$remaining_amount;\n  const isArrival = type === 'arrival';\n  const isDeparture = type === 'departure';\n  const isInhouse = type === 'inhouse';\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white rounded-lg shadow border border-gray-200 p-3 flex flex-col gap-2 text-sm\",\n    dir: \"rtl\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between gap-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"min-w-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-semibold truncate\",\n          children: res.guest_name || 'نزيل غير محدد'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 28,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-500 truncate\",\n          children: [res.guest_phone || '', res.guest_phone && res.guest_email ? ' • ' : '', res.guest_email || '']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 29,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(StatusBadge, {\n        status: res.status\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-2 gap-x-4 gap-y-1 text-xs md:text-sm\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-gray-500\",\n          children: \"\\u0627\\u0644\\u063A\\u0631\\u0641\\u0629:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 14\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium\",\n          children: res.room_label || res.room_id\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 61\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-gray-500\",\n          children: \"\\u0646\\u0648\\u0639 \\u0627\\u0644\\u063A\\u0631\\u0641\\u0629:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 14\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium\",\n          children: res.room_type_name || '-'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 65\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-gray-500\",\n          children: \"\\u0627\\u0644\\u062F\\u062E\\u0648\\u0644 \\u0627\\u0644\\u0645\\u062D\\u062C\\u0648\\u0632:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 40,\n          columnNumber: 14\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium\",\n          children: res.check_in_date\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 40,\n          columnNumber: 69\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-gray-500\",\n          children: \"\\u0627\\u0644\\u062E\\u0631\\u0648\\u062C \\u0627\\u0644\\u0645\\u062D\\u062C\\u0648\\u0632:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 14\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium\",\n          children: res.check_out_date\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 69\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-gray-500\",\n          children: \"\\u0639\\u062F\\u062F \\u0627\\u0644\\u0646\\u0632\\u0644\\u0627\\u0621:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 14\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium\",\n          children: res.guests_count || 0\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 66\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-gray-500\",\n          children: \"\\u0627\\u0644\\u0645\\u062A\\u0628\\u0642\\u064A:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 14\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium text-red-700\",\n          children: (_res$remaining_amount = res.remaining_amount) !== null && _res$remaining_amount !== void 0 ? _res$remaining_amount : 0\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 62\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 7\n    }, this), res.special_requests && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-xs text-amber-700 bg-amber-50 border border-amber-100 rounded px-2 py-1\",\n      children: [\"\\u0637\\u0644\\u0628\\u0627\\u062A \\u062E\\u0627\\u0635\\u0629: \", res.special_requests]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-wrap items-center justify-end gap-2 pt-1\",\n      children: [isArrival && (res.status === 'pending' || res.status === 'confirmed') && /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"px-3 py-1 rounded text-xs bg-blue-600 hover:bg-blue-700 text-white\",\n        onClick: () => onCheckIn && onCheckIn(res),\n        children: \"\\u062A\\u0633\\u062C\\u064A\\u0644 \\u062F\\u062E\\u0648\\u0644\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 11\n      }, this), isDeparture && res.status === 'checked_in' && /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"px-3 py-1 rounded text-xs bg-emerald-600 hover:bg-emerald-700 text-white\",\n        onClick: () => onCheckOut && onCheckOut(res),\n        children: \"\\u062A\\u0633\\u062C\\u064A\\u0644 \\u062E\\u0631\\u0648\\u062C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 11\n      }, this), isInhouse && res.status === 'checked_in' && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-xs text-gray-500\",\n        children: \"\\u0645\\u0642\\u064A\\u0645 \\u062D\\u0627\\u0644\\u064A\\u0627\\u064B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 25,\n    columnNumber: 5\n  }, this);\n}\n_c2 = CheckInOutCard;\nexport default function CheckInOut() {\n  _s();\n  const currentUser = useContext(AuthContext);\n  const [date, setDate] = useState(() => new Date().toISOString().slice(0, 10));\n  const [rows, setRows] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [search, setSearch] = useState('');\n  const [logRows, setLogRows] = useState([]);\n  const [logLoading, setLogLoading] = useState(true);\n  useEffect(() => {\n    const load = async () => {\n      setLoading(true);\n      try {\n        const {\n          data,\n          error\n        } = await supabase.from('reservations_overview').select('*').or(`check_in_date.eq.${date},check_out_date.eq.${date},and(is_current.eq.true,status.eq.checked_in)`);\n        if (error) throw error;\n        setRows(data || []);\n      } catch (e) {\n        console.error('Load check-in/out overview failed', e);\n        setRows([]);\n      } finally {\n        setLoading(false);\n      }\n    };\n    load();\n  }, [date]);\n  useEffect(() => {\n    const loadLog = async () => {\n      setLogLoading(true);\n      try {\n        const dateObj = new Date(date);\n        if (Number.isNaN(dateObj.getTime())) {\n          setLogRows([]);\n          return;\n        }\n        const start = new Date(dateObj);\n        start.setHours(0, 0, 0, 0);\n        const end = new Date(start);\n        end.setDate(end.getDate() + 1);\n        const {\n          data,\n          error\n        } = await supabase.from('staff_activity_overview').select('*').eq('entity_type', 'reservation').eq('action', 'status_change').gte('created_at', start.toISOString()).lt('created_at', end.toISOString());\n        if (error) throw error;\n        const onlyCheckInOut = (data || []).filter(r => {\n          var _r$metadata, _r$metadata$new;\n          const newStatus = r === null || r === void 0 ? void 0 : (_r$metadata = r.metadata) === null || _r$metadata === void 0 ? void 0 : (_r$metadata$new = _r$metadata.new) === null || _r$metadata$new === void 0 ? void 0 : _r$metadata$new.status;\n          return newStatus === 'checked_in' || newStatus === 'checked_out';\n        });\n        setLogRows(onlyCheckInOut);\n      } catch (e) {\n        console.error('Load check-in/out activity log failed', e);\n        setLogRows([]);\n      } finally {\n        setLogLoading(false);\n      }\n    };\n    loadLog();\n  }, [date]);\n  const filtered = useMemo(() => {\n    const term = (search || '').trim().toLowerCase();\n    if (!term) return rows;\n    return rows.filter(r => {\n      const guest = (r.guest_name || '').toLowerCase();\n      const phone = (r.guest_phone || '').toLowerCase();\n      const room = (r.room_label || String(r.room_id || '')).toLowerCase();\n      return guest.includes(term) || phone.includes(term) || room.includes(term);\n    });\n  }, [rows, search]);\n  const arrivals = useMemo(() => filtered.filter(r => r.check_in_date === date && ['pending', 'confirmed'].includes(r.status)), [filtered, date]);\n  const inhouse = useMemo(() => filtered.filter(r => r.is_current && r.status === 'checked_in'), [filtered]);\n  const departures = useMemo(() => filtered.filter(r => r.check_out_date === date && r.status === 'checked_in'), [filtered, date]);\n  const handleCheckIn = async res => {\n    try {\n      const ok = window.confirm(`تأكيد تسجيل دخول النزيل ${res.guest_name || ''} إلى الغرفة ${res.room_label || res.room_id}؟`);\n      if (!ok) return;\n      const payload = {\n        status: 'checked_in'\n      };\n      if (currentUser && currentUser.id) payload.updated_by = currentUser.id;\n      const {\n        error\n      } = await supabase.from('reservations').update(payload).eq('id', res.id);\n      if (error) throw error;\n      // إعادة التحميل\n      const {\n        data,\n        error: e2\n      } = await supabase.from('reservations_overview').select('*').or(`check_in_date.eq.${date},check_out_date.eq.${date},and(is_current.eq.true,status.eq.checked_in)`);\n      if (!e2) setRows(data || []);\n      window.alert('تم تسجيل الدخول بنجاح.');\n    } catch (e) {\n      console.error('Check-in failed', e);\n      window.alert('تعذّر تسجيل الدخول للحجز: ' + (e.message || e));\n    }\n  };\n  const handleCheckOut = async res => {\n    try {\n      const ok = window.confirm(`تأكيد تسجيل خروج النزيل ${res.guest_name || ''} من الغرفة ${res.room_label || res.room_id}؟`);\n      if (!ok) return;\n      const payload = {\n        status: 'checked_out'\n      };\n      if (currentUser && currentUser.id) payload.updated_by = currentUser.id;\n      const {\n        error\n      } = await supabase.from('reservations').update(payload).eq('id', res.id);\n      if (error) throw error;\n      const {\n        data,\n        error: e2\n      } = await supabase.from('reservations_overview').select('*').or(`check_in_date.eq.${date},check_out_date.eq.${date},and(is_current.eq.true,status.eq.checked_in)`);\n      if (!e2) setRows(data || []);\n      window.alert('تم تسجيل الخروج بنجاح.');\n    } catch (e) {\n      console.error('Check-out failed', e);\n      window.alert('تعذّر تسجيل الخروج للحجز: ' + (e.message || e));\n    }\n  };\n  if (!canAccessPage(currentUser, 'checkin-out')) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-8\",\n      dir: \"rtl\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-lg mx-auto bg-red-50 border border-red-200 text-red-700 rounded-lg p-4 text-sm\",\n        children: \"\\u0644\\u0627 \\u062A\\u0645\\u0644\\u0643 \\u0635\\u0644\\u0627\\u062D\\u064A\\u0629 \\u0627\\u0644\\u0648\\u0635\\u0648\\u0644 \\u0625\\u0644\\u0649 \\u0635\\u0641\\u062D\\u0629 \\u062A\\u0633\\u062C\\u064A\\u0644 \\u0627\\u0644\\u062F\\u062E\\u0648\\u0644/\\u0627\\u0644\\u062E\\u0631\\u0648\\u062C. \\u0647\\u0630\\u0647 \\u0627\\u0644\\u0635\\u0641\\u062D\\u0629 \\u0645\\u062E\\u0635\\u0635\\u0629 \\u0644\\u0644\\u0625\\u062F\\u0627\\u0631\\u0629 \\u0648\\u0627\\u0644\\u0627\\u0633\\u062A\\u0642\\u0628\\u0627\\u0644.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-8\",\n    dir: \"rtl\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold mb-1\",\n          children: \"\\u062A\\u0633\\u062C\\u064A\\u0644 \\u062F\\u062E\\u0648\\u0644/\\u062E\\u0631\\u0648\\u062C \\u0627\\u0644\\u0646\\u0632\\u0644\\u0627\\u0621\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500\",\n          children: \"\\u0634\\u0627\\u0634\\u0629 \\u0627\\u0633\\u062A\\u0642\\u0628\\u0627\\u0644 \\u0645\\u062E\\u0635\\u0635\\u0629 \\u0644\\u0648\\u0635\\u0648\\u0644 \\u0648\\u0645\\u063A\\u0627\\u062F\\u0631\\u0629 \\u0627\\u0644\\u0646\\u0632\\u0644\\u0627\\u0621 \\u0645\\u0639 \\u0631\\u0628\\u0637 \\u0645\\u0628\\u0627\\u0634\\u0631 \\u0628\\u0627\\u0644\\u062D\\u062C\\u0648\\u0632\\u0627\\u062A.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"date\",\n          className: \"border rounded px-3 py-2 text-sm\",\n          value: date,\n          onChange: e => setDate(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"border rounded px-3 py-2 bg-white hover:bg-gray-50 text-sm\",\n          onClick: () => setDate(new Date().toISOString().slice(0, 10)),\n          children: \"\\u0627\\u0644\\u064A\\u0648\\u0645\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-wrap items-center gap-3 mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative flex-1 min-w-[220px]\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-4 h-4\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            strokeWidth: \"2\",\n            children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n              cx: \"11\",\n              cy: \"11\",\n              r: \"7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M21 21l-4.3-4.3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"border rounded pl-9 pr-3 py-2 w-full text-sm\",\n          placeholder: \"\\u0628\\u062D\\u062B \\u0628\\u0627\\u0644\\u0627\\u0633\\u0645 / \\u0627\\u0644\\u0647\\u0627\\u062A\\u0641 / \\u0627\\u0644\\u063A\\u0631\\u0641\\u0629\",\n          value: search,\n          onChange: e => setSearch(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-blue-50 border border-blue-200 rounded p-3 flex flex-col\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-blue-700\",\n          children: \"\\u0648\\u0635\\u0648\\u0644 \\u0627\\u0644\\u064A\\u0648\\u0645\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-2xl font-bold text-blue-700\",\n          children: arrivals.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-emerald-50 border border-emerald-200 rounded p-3 flex flex-col\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-emerald-700\",\n          children: \"\\u0645\\u0642\\u064A\\u0645\\u0648\\u0646 \\u0627\\u0644\\u0622\\u0646\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-2xl font-bold text-emerald-700\",\n          children: inhouse.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-amber-50 border border-amber-200 rounded p-3 flex flex-col\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-amber-700\",\n          children: \"\\u0645\\u063A\\u0627\\u062F\\u0631\\u0648\\u0646 \\u0627\\u0644\\u064A\\u0648\\u0645\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-2xl font-bold text-amber-700\",\n          children: departures.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"py-12 text-center text-gray-500\",\n      children: \"...\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u062A\\u062D\\u0645\\u064A\\u0644\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold\",\n            children: \"\\u0648\\u0635\\u0648\\u0644 \\u0627\\u0644\\u064A\\u0648\\u0645\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-gray-500\",\n            children: \"\\u0627\\u0644\\u062D\\u062C\\u0648\\u0632\\u0627\\u062A \\u0627\\u0644\\u0645\\u0624\\u0643\\u062F\\u0629 / \\u0642\\u064A\\u062F \\u0627\\u0644\\u0627\\u0646\\u062A\\u0638\\u0627\\u0631 \\u0628\\u062A\\u0627\\u0631\\u064A\\u062E \\u0627\\u0644\\u064A\\u0648\\u0645\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 13\n        }, this), arrivals.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\",\n          children: \"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0648\\u0635\\u0648\\u0644\\u0627\\u062A \\u0645\\u062C\\u062F\\u0648\\u0644\\u0629 \\u0644\\u0647\\u0630\\u0627 \\u0627\\u0644\\u064A\\u0648\\u0645.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\",\n          children: arrivals.map(r => /*#__PURE__*/_jsxDEV(CheckInOutCard, {\n            res: r,\n            type: \"arrival\",\n            onCheckIn: handleCheckIn\n          }, r.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold\",\n            children: \"\\u0645\\u0642\\u064A\\u0645\\u0648\\u0646 \\u0627\\u0644\\u0622\\u0646\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-gray-500\",\n            children: \"\\u0643\\u0644 \\u0627\\u0644\\u062D\\u062C\\u0648\\u0632\\u0627\\u062A \\u0628\\u062D\\u0627\\u0644\\u0629 \\u062A\\u0645 \\u0627\\u0644\\u062F\\u062E\\u0648\\u0644 \\u0648\\u062D\\u0627\\u0644\\u064A\\u0629\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 13\n        }, this), inhouse.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\",\n          children: \"\\u0644\\u0627 \\u064A\\u0648\\u062C\\u062F \\u0646\\u0632\\u0644\\u0627\\u0621 \\u0645\\u0642\\u064A\\u0645\\u0648\\u0646 \\u062D\\u0627\\u0644\\u064A\\u064B\\u0627 \\u062D\\u0633\\u0628 \\u0627\\u0644\\u062A\\u0648\\u0627\\u0631\\u064A\\u062E.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\",\n          children: inhouse.map(r => /*#__PURE__*/_jsxDEV(CheckInOutCard, {\n            res: r,\n            type: \"inhouse\"\n          }, r.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold\",\n            children: \"\\u0645\\u063A\\u0627\\u062F\\u0631\\u0648\\u0646 \\u0627\\u0644\\u064A\\u0648\\u0645\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-gray-500\",\n            children: \"\\u0627\\u0644\\u062D\\u062C\\u0648\\u0632\\u0627\\u062A \\u0627\\u0644\\u062A\\u064A \\u062A\\u0627\\u0631\\u064A\\u062E \\u062E\\u0631\\u0648\\u062C\\u0647\\u0627 \\u0627\\u0644\\u064A\\u0648\\u0645\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 13\n        }, this), departures.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\",\n          children: \"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0645\\u063A\\u0627\\u062F\\u0631\\u0627\\u062A \\u0645\\u062C\\u062F\\u0648\\u0644\\u0629 \\u0644\\u0647\\u0630\\u0627 \\u0627\\u0644\\u064A\\u0648\\u0645.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\",\n          children: departures.map(r => /*#__PURE__*/_jsxDEV(CheckInOutCard, {\n            res: r,\n            type: \"departure\",\n            onCheckOut: handleCheckOut\n          }, r.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold\",\n            children: \"\\u0633\\u062C\\u0644 \\u0627\\u0644\\u062F\\u062E\\u0648\\u0644 \\u0648\\u0627\\u0644\\u062E\\u0631\\u0648\\u062C \\u0644\\u0644\\u064A\\u0648\\u0645\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs text-gray-500\",\n            children: \"\\u064A\\u0639\\u0631\\u0636 \\u0643\\u0644 \\u0639\\u0645\\u0644\\u064A\\u0627\\u062A \\u062A\\u063A\\u064A\\u064A\\u0631 \\u0627\\u0644\\u062D\\u0627\\u0644\\u0629 \\u0625\\u0644\\u0649 \\u062A\\u0645 \\u0627\\u0644\\u062F\\u062E\\u0648\\u0644 / \\u062A\\u0645 \\u0627\\u0644\\u062E\\u0631\\u0648\\u062C \\u0641\\u064A \\u0647\\u0630\\u0627 \\u0627\\u0644\\u064A\\u0648\\u0645\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 13\n        }, this), logLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\",\n          children: \"...\\u062C\\u0627\\u0631\\u064A \\u062A\\u062D\\u0645\\u064A\\u0644 \\u0633\\u062C\\u0644 \\u0627\\u0644\\u062F\\u062E\\u0648\\u0644/\\u0627\\u0644\\u062E\\u0631\\u0648\\u062C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 15\n        }, this) : logRows.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\",\n          children: \"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0639\\u0645\\u0644\\u064A\\u0627\\u062A \\u062A\\u0633\\u062C\\u064A\\u0644 \\u062F\\u062E\\u0648\\u0644/\\u062E\\u0631\\u0648\\u062C \\u0645\\u0633\\u062C\\u0651\\u064E\\u0644\\u0629 \\u0644\\u0647\\u0630\\u0627 \\u0627\\u0644\\u064A\\u0648\\u0645.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded border border-gray-200 overflow-hidden\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"min-w-full text-xs md:text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"bg-gray-50 text-right\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"px-3 py-2\",\n                  children: \"\\u0627\\u0644\\u0648\\u0642\\u062A\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 344,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"px-3 py-2\",\n                  children: \"\\u0627\\u0644\\u0645\\u0648\\u0638\\u0641\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 345,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"px-3 py-2\",\n                  children: \"\\u0627\\u0644\\u0646\\u0648\\u0639\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 346,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"px-3 py-2\",\n                  children: \"\\u0627\\u0644\\u062A\\u0641\\u0627\\u0635\\u064A\\u0644\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 347,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: logRows.map(r => {\n                var _r$metadata2, _r$metadata2$new;\n                const dt = r.created_at ? new Date(r.created_at) : null;\n                const timeStr = dt ? dt.toLocaleTimeString('ar-EG', {\n                  hour: '2-digit',\n                  minute: '2-digit'\n                }) : '';\n                const newStatus = r === null || r === void 0 ? void 0 : (_r$metadata2 = r.metadata) === null || _r$metadata2 === void 0 ? void 0 : (_r$metadata2$new = _r$metadata2.new) === null || _r$metadata2$new === void 0 ? void 0 : _r$metadata2$new.status;\n                const kind = newStatus === 'checked_in' ? 'تسجيل دخول' : 'تسجيل خروج';\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"border-t hover:bg-gray-50\",\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-3 py-1 whitespace-nowrap text-gray-600\",\n                    children: timeStr\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 360,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-3 py-1\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-xs md:text-sm font-medium\",\n                      children: r.staff_name || 'غير محدد'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 362,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-[10px] md:text-xs text-gray-500\",\n                      children: r.staff_username || ''\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 363,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 361,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-3 py-1 text-xs md:text-sm\",\n                    children: kind\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 365,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-3 py-1 text-xs md:text-sm max-w-xl whitespace-normal break-words\",\n                    children: r.details\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 366,\n                    columnNumber: 27\n                  }, this)]\n                }, r.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 359,\n                  columnNumber: 25\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 223,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckInOut, \"BVp7ndkAYXwN4GXtHPjV2xLAkk0=\");\n_c3 = CheckInOut;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"StatusBadge\");\n$RefreshReg$(_c2, \"CheckInOutCard\");\n$RefreshReg$(_c3, \"CheckInOut\");","map":{"version":3,"names":["React","useContext","useEffect","useMemo","useState","supabase","AuthContext","canAccessPage","jsxDEV","_jsxDEV","StatusBadge","status","map","pending","text","cls","confirmed","checked_in","checked_out","cancelled","no_show","v","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","CheckInOutCard","res","type","onCheckIn","onCheckOut","_res$remaining_amount","isArrival","isDeparture","isInhouse","dir","guest_name","guest_phone","guest_email","room_label","room_id","room_type_name","check_in_date","check_out_date","guests_count","remaining_amount","special_requests","onClick","_c2","CheckInOut","_s","currentUser","date","setDate","Date","toISOString","slice","rows","setRows","loading","setLoading","search","setSearch","logRows","setLogRows","logLoading","setLogLoading","load","data","error","from","select","or","e","console","loadLog","dateObj","Number","isNaN","getTime","start","setHours","end","getDate","eq","gte","lt","onlyCheckInOut","filter","r","_r$metadata","_r$metadata$new","newStatus","metadata","new","filtered","term","trim","toLowerCase","guest","phone","room","String","includes","arrivals","inhouse","is_current","departures","handleCheckIn","ok","window","confirm","payload","id","updated_by","update","e2","alert","message","handleCheckOut","value","onChange","target","viewBox","fill","stroke","strokeWidth","cx","cy","d","placeholder","length","_r$metadata2","_r$metadata2$new","dt","created_at","timeStr","toLocaleTimeString","hour","minute","kind","staff_name","staff_username","details","_c3","$RefreshReg$"],"sources":["F:/kelany/src/pages/CheckInOut.jsx"],"sourcesContent":["import React, { useContext, useEffect, useMemo, useState } from 'react';\r\nimport { supabase } from '../supabaseClient';\r\nimport { AuthContext } from '../App.jsx';\r\nimport { canAccessPage } from '../utils/permissions';\r\n\r\nfunction StatusBadge({ status }) {\r\n  const map = {\r\n    pending: { text: 'قيد الانتظار', cls: 'bg-yellow-100 text-yellow-800' },\r\n    confirmed: { text: 'مؤكد', cls: 'bg-green-100 text-green-800' },\r\n    checked_in: { text: 'تم الدخول', cls: 'bg-blue-100 text-blue-800' },\r\n    checked_out: { text: 'تم الخروج', cls: 'bg-gray-100 text-gray-800' },\r\n    cancelled: { text: 'ملغي', cls: 'bg-red-100 text-red-800' },\r\n    no_show: { text: 'لم يحضر', cls: 'bg-orange-100 text-orange-800' },\r\n  };\r\n  const v = map[status] || { text: status, cls: 'bg-slate-100 text-slate-700' };\r\n  return <span className={`px-2 py-0.5 rounded text-xs font-medium ${v.cls}`}>{v.text}</span>;\r\n}\r\n\r\nfunction CheckInOutCard({ res, type, onCheckIn, onCheckOut }) {\r\n  const isArrival = type === 'arrival';\r\n  const isDeparture = type === 'departure';\r\n  const isInhouse = type === 'inhouse';\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow border border-gray-200 p-3 flex flex-col gap-2 text-sm\" dir=\"rtl\">\r\n      <div className=\"flex items-center justify-between gap-2\">\r\n        <div className=\"min-w-0\">\r\n          <div className=\"font-semibold truncate\">{res.guest_name || 'نزيل غير محدد'}</div>\r\n          <div className=\"text-xs text-gray-500 truncate\">\r\n            {res.guest_phone || ''}\r\n            {res.guest_phone && res.guest_email ? ' • ' : ''}\r\n            {res.guest_email || ''}\r\n          </div>\r\n        </div>\r\n        <StatusBadge status={res.status} />\r\n      </div>\r\n      <div className=\"grid grid-cols-2 gap-x-4 gap-y-1 text-xs md:text-sm\">\r\n        <div><span className=\"text-gray-500\">الغرفة:</span> <span className=\"font-medium\">{res.room_label || res.room_id}</span></div>\r\n        <div><span className=\"text-gray-500\">نوع الغرفة:</span> <span className=\"font-medium\">{res.room_type_name || '-'}</span></div>\r\n        <div><span className=\"text-gray-500\">الدخول المحجوز:</span> <span className=\"font-medium\">{res.check_in_date}</span></div>\r\n        <div><span className=\"text-gray-500\">الخروج المحجوز:</span> <span className=\"font-medium\">{res.check_out_date}</span></div>\r\n        <div><span className=\"text-gray-500\">عدد النزلاء:</span> <span className=\"font-medium\">{res.guests_count || 0}</span></div>\r\n        <div><span className=\"text-gray-500\">المتبقي:</span> <span className=\"font-medium text-red-700\">{res.remaining_amount ?? 0}</span></div>\r\n      </div>\r\n      {res.special_requests && (\r\n        <div className=\"text-xs text-amber-700 bg-amber-50 border border-amber-100 rounded px-2 py-1\">\r\n          طلبات خاصة: {res.special_requests}\r\n        </div>\r\n      )}\r\n      <div className=\"flex flex-wrap items-center justify-end gap-2 pt-1\">\r\n        {isArrival && (res.status === 'pending' || res.status === 'confirmed') && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"px-3 py-1 rounded text-xs bg-blue-600 hover:bg-blue-700 text-white\"\r\n            onClick={() => onCheckIn && onCheckIn(res)}\r\n          >\r\n            تسجيل دخول\r\n          </button>\r\n        )}\r\n        {isDeparture && res.status === 'checked_in' && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"px-3 py-1 rounded text-xs bg-emerald-600 hover:bg-emerald-700 text-white\"\r\n            onClick={() => onCheckOut && onCheckOut(res)}\r\n          >\r\n            تسجيل خروج\r\n          </button>\r\n        )}\r\n        {isInhouse && res.status === 'checked_in' && (\r\n          <span className=\"text-xs text-gray-500\">مقيم حالياً</span>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function CheckInOut() {\r\n  const currentUser = useContext(AuthContext);\r\n  const [date, setDate] = useState(() => new Date().toISOString().slice(0, 10));\r\n  const [rows, setRows] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [search, setSearch] = useState('');\r\n  const [logRows, setLogRows] = useState([]);\r\n  const [logLoading, setLogLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const load = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const { data, error } = await supabase\r\n          .from('reservations_overview')\r\n          .select('*')\r\n          .or(`check_in_date.eq.${date},check_out_date.eq.${date},and(is_current.eq.true,status.eq.checked_in)`);\r\n        if (error) throw error;\r\n        setRows(data || []);\r\n      } catch (e) {\r\n        console.error('Load check-in/out overview failed', e);\r\n        setRows([]);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    load();\r\n  }, [date]);\r\n\r\n  useEffect(() => {\r\n    const loadLog = async () => {\r\n      setLogLoading(true);\r\n      try {\r\n        const dateObj = new Date(date);\r\n        if (Number.isNaN(dateObj.getTime())) {\r\n          setLogRows([]);\r\n          return;\r\n        }\r\n\r\n        const start = new Date(dateObj);\r\n        start.setHours(0, 0, 0, 0);\r\n        const end = new Date(start);\r\n        end.setDate(end.getDate() + 1);\r\n\r\n        const { data, error } = await supabase\r\n          .from('staff_activity_overview')\r\n          .select('*')\r\n          .eq('entity_type', 'reservation')\r\n          .eq('action', 'status_change')\r\n          .gte('created_at', start.toISOString())\r\n          .lt('created_at', end.toISOString());\r\n\r\n        if (error) throw error;\r\n\r\n        const onlyCheckInOut = (data || []).filter((r) => {\r\n          const newStatus = r?.metadata?.new?.status;\r\n          return newStatus === 'checked_in' || newStatus === 'checked_out';\r\n        });\r\n\r\n        setLogRows(onlyCheckInOut);\r\n      } catch (e) {\r\n        console.error('Load check-in/out activity log failed', e);\r\n        setLogRows([]);\r\n      } finally {\r\n        setLogLoading(false);\r\n      }\r\n    };\r\n\r\n    loadLog();\r\n  }, [date]);\r\n\r\n  const filtered = useMemo(() => {\r\n    const term = (search || '').trim().toLowerCase();\r\n    if (!term) return rows;\r\n    return rows.filter(r => {\r\n      const guest = (r.guest_name || '').toLowerCase();\r\n      const phone = (r.guest_phone || '').toLowerCase();\r\n      const room = (r.room_label || String(r.room_id || '')).toLowerCase();\r\n      return guest.includes(term) || phone.includes(term) || room.includes(term);\r\n    });\r\n  }, [rows, search]);\r\n\r\n  const arrivals = useMemo(() => (\r\n    filtered.filter(r => r.check_in_date === date && ['pending', 'confirmed'].includes(r.status))\r\n  ), [filtered, date]);\r\n\r\n  const inhouse = useMemo(() => (\r\n    filtered.filter(r => r.is_current && r.status === 'checked_in')\r\n  ), [filtered]);\r\n\r\n  const departures = useMemo(() => (\r\n    filtered.filter(r => r.check_out_date === date && r.status === 'checked_in')\r\n  ), [filtered, date]);\r\n\r\n  const handleCheckIn = async (res) => {\r\n    try {\r\n      const ok = window.confirm(`تأكيد تسجيل دخول النزيل ${res.guest_name || ''} إلى الغرفة ${res.room_label || res.room_id}؟`);\r\n      if (!ok) return;\r\n      const payload = { status: 'checked_in' };\r\n      if (currentUser && currentUser.id) payload.updated_by = currentUser.id;\r\n      const { error } = await supabase.from('reservations').update(payload).eq('id', res.id);\r\n      if (error) throw error;\r\n      // إعادة التحميل\r\n      const { data, error: e2 } = await supabase\r\n        .from('reservations_overview')\r\n        .select('*')\r\n        .or(`check_in_date.eq.${date},check_out_date.eq.${date},and(is_current.eq.true,status.eq.checked_in)`);\r\n      if (!e2) setRows(data || []);\r\n      window.alert('تم تسجيل الدخول بنجاح.');\r\n    } catch (e) {\r\n      console.error('Check-in failed', e);\r\n      window.alert('تعذّر تسجيل الدخول للحجز: ' + (e.message || e));\r\n    }\r\n  };\r\n\r\n  const handleCheckOut = async (res) => {\r\n    try {\r\n      const ok = window.confirm(`تأكيد تسجيل خروج النزيل ${res.guest_name || ''} من الغرفة ${res.room_label || res.room_id}؟`);\r\n      if (!ok) return;\r\n      const payload = { status: 'checked_out' };\r\n      if (currentUser && currentUser.id) payload.updated_by = currentUser.id;\r\n      const { error } = await supabase.from('reservations').update(payload).eq('id', res.id);\r\n      if (error) throw error;\r\n      const { data, error: e2 } = await supabase\r\n        .from('reservations_overview')\r\n        .select('*')\r\n        .or(`check_in_date.eq.${date},check_out_date.eq.${date},and(is_current.eq.true,status.eq.checked_in)`);\r\n      if (!e2) setRows(data || []);\r\n      window.alert('تم تسجيل الخروج بنجاح.');\r\n    } catch (e) {\r\n      console.error('Check-out failed', e);\r\n      window.alert('تعذّر تسجيل الخروج للحجز: ' + (e.message || e));\r\n    }\r\n  };\r\n\r\n  if (!canAccessPage(currentUser, 'checkin-out')) {\r\n    return (\r\n      <div className=\"p-8\" dir=\"rtl\">\r\n        <div className=\"max-w-lg mx-auto bg-red-50 border border-red-200 text-red-700 rounded-lg p-4 text-sm\">\r\n          لا تملك صلاحية الوصول إلى صفحة تسجيل الدخول/الخروج. هذه الصفحة مخصصة للإدارة والاستقبال.\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-8\" dir=\"rtl\">\r\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold mb-1\">تسجيل دخول/خروج النزلاء</h2>\r\n          <p className=\"text-sm text-gray-500\">شاشة استقبال مخصصة لوصول ومغادرة النزلاء مع ربط مباشر بالحجوزات.</p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <input\r\n            type=\"date\"\r\n            className=\"border rounded px-3 py-2 text-sm\"\r\n            value={date}\r\n            onChange={(e) => setDate(e.target.value)}\r\n          />\r\n          <button\r\n            type=\"button\"\r\n            className=\"border rounded px-3 py-2 bg-white hover:bg-gray-50 text-sm\"\r\n            onClick={() => setDate(new Date().toISOString().slice(0, 10))}\r\n          >\r\n            اليوم\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex flex-wrap items-center gap-3 mb-4\">\r\n        <div className=\"relative flex-1 min-w-[220px]\">\r\n          <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\">\r\n            <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n              <circle cx=\"11\" cy=\"11\" r=\"7\" />\r\n              <path d=\"M21 21l-4.3-4.3\" />\r\n            </svg>\r\n          </span>\r\n          <input\r\n            className=\"border rounded pl-9 pr-3 py-2 w-full text-sm\"\r\n            placeholder=\"بحث بالاسم / الهاتف / الغرفة\"\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm\">\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded p-3 flex flex-col\">\r\n          <span className=\"text-xs text-blue-700\">وصول اليوم</span>\r\n          <span className=\"text-2xl font-bold text-blue-700\">{arrivals.length}</span>\r\n        </div>\r\n        <div className=\"bg-emerald-50 border border-emerald-200 rounded p-3 flex flex-col\">\r\n          <span className=\"text-xs text-emerald-700\">مقيمون الآن</span>\r\n          <span className=\"text-2xl font-bold text-emerald-700\">{inhouse.length}</span>\r\n        </div>\r\n        <div className=\"bg-amber-50 border border-amber-200 rounded p-3 flex flex-col\">\r\n          <span className=\"text-xs text-amber-700\">مغادرون اليوم</span>\r\n          <span className=\"text-2xl font-bold text-amber-700\">{departures.length}</span>\r\n        </div>\r\n      </div>\r\n\r\n      {loading ? (\r\n        <div className=\"py-12 text-center text-gray-500\">...جاري التحميل</div>\r\n      ) : (\r\n        <div className=\"space-y-8\">\r\n          <section>\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <h3 className=\"text-lg font-semibold\">وصول اليوم</h3>\r\n              <span className=\"text-xs text-gray-500\">الحجوزات المؤكدة / قيد الانتظار بتاريخ اليوم</span>\r\n            </div>\r\n            {arrivals.length === 0 ? (\r\n              <div className=\"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\">لا توجد وصولات مجدولة لهذا اليوم.</div>\r\n            ) : (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\">\r\n                {arrivals.map(r => (\r\n                  <CheckInOutCard key={r.id} res={r} type=\"arrival\" onCheckIn={handleCheckIn} />\r\n                ))}\r\n              </div>\r\n            )}\r\n          </section>\r\n\r\n          <section>\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <h3 className=\"text-lg font-semibold\">مقيمون الآن</h3>\r\n              <span className=\"text-xs text-gray-500\">كل الحجوزات بحالة تم الدخول وحالية</span>\r\n            </div>\r\n            {inhouse.length === 0 ? (\r\n              <div className=\"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\">لا يوجد نزلاء مقيمون حاليًا حسب التواريخ.</div>\r\n            ) : (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\">\r\n                {inhouse.map(r => (\r\n                  <CheckInOutCard key={r.id} res={r} type=\"inhouse\" />\r\n                ))}\r\n              </div>\r\n            )}\r\n          </section>\r\n\r\n          <section>\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <h3 className=\"text-lg font-semibold\">مغادرون اليوم</h3>\r\n              <span className=\"text-xs text-gray-500\">الحجوزات التي تاريخ خروجها اليوم</span>\r\n            </div>\r\n            {departures.length === 0 ? (\r\n              <div className=\"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\">لا توجد مغادرات مجدولة لهذا اليوم.</div>\r\n            ) : (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4\">\r\n                {departures.map(r => (\r\n                  <CheckInOutCard key={r.id} res={r} type=\"departure\" onCheckOut={handleCheckOut} />\r\n                ))}\r\n              </div>\r\n            )}\r\n          </section>\r\n\r\n          <section>\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <h3 className=\"text-lg font-semibold\">سجل الدخول والخروج لليوم</h3>\r\n              <span className=\"text-xs text-gray-500\">يعرض كل عمليات تغيير الحالة إلى تم الدخول / تم الخروج في هذا اليوم</span>\r\n            </div>\r\n            {logLoading ? (\r\n              <div className=\"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\">...جاري تحميل سجل الدخول/الخروج</div>\r\n            ) : logRows.length === 0 ? (\r\n              <div className=\"text-sm text-gray-500 bg-white rounded border border-dashed border-gray-200 p-4\">لا توجد عمليات تسجيل دخول/خروج مسجَّلة لهذا اليوم.</div>\r\n            ) : (\r\n              <div className=\"bg-white rounded border border-gray-200 overflow-hidden\">\r\n                <table className=\"min-w-full text-xs md:text-sm\">\r\n                  <thead className=\"bg-gray-50 text-right\">\r\n                    <tr>\r\n                      <th className=\"px-3 py-2\">الوقت</th>\r\n                      <th className=\"px-3 py-2\">الموظف</th>\r\n                      <th className=\"px-3 py-2\">النوع</th>\r\n                      <th className=\"px-3 py-2\">التفاصيل</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {logRows.map((r) => {\r\n                      const dt = r.created_at ? new Date(r.created_at) : null;\r\n                      const timeStr = dt\r\n                        ? dt.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' })\r\n                        : '';\r\n                      const newStatus = r?.metadata?.new?.status;\r\n                      const kind = newStatus === 'checked_in' ? 'تسجيل دخول' : 'تسجيل خروج';\r\n                      return (\r\n                        <tr key={r.id} className=\"border-t hover:bg-gray-50\">\r\n                          <td className=\"px-3 py-1 whitespace-nowrap text-gray-600\">{timeStr}</td>\r\n                          <td className=\"px-3 py-1\">\r\n                            <div className=\"text-xs md:text-sm font-medium\">{r.staff_name || 'غير محدد'}</div>\r\n                            <div className=\"text-[10px] md:text-xs text-gray-500\">{r.staff_username || ''}</div>\r\n                          </td>\r\n                          <td className=\"px-3 py-1 text-xs md:text-sm\">{kind}</td>\r\n                          <td className=\"px-3 py-1 text-xs md:text-sm max-w-xl whitespace-normal break-words\">{r.details}</td>\r\n                        </tr>\r\n                      );\r\n                    })}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            )}\r\n          </section>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}