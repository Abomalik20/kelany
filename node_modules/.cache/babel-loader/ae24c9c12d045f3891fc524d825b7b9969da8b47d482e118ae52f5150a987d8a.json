{"ast":null,"code":"import _objectSpread from\"F:/kelany/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useState}from'react';import{supabase}from'../supabaseClient';import RoomModal from'../components/RoomModal';import RoomCard from'../components/RoomCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Rooms(){const[rooms,setRooms]=useState([]);const[loading,setLoading]=useState(true);const[showModal,setShowModal]=useState(false);const[editing,setEditing]=useState(null);const[buildings,setBuildings]=useState([]);const[floors,setFloors]=useState([]);const[roomTypes,setRoomTypes]=useState([]);const[filterBuilding,setFilterBuilding]=useState('all');const[filterFloor,setFilterFloor]=useState('all');const[statusFilters,setStatusFilters]=useState({available:true,reserved:true,occupied:true,maintenance:true});const[cleanFilters,setCleanFilters]=useState({clean:true,in_cleaning:true,needs_cleaning:true});const[search,setSearch]=useState('');const[debounced,setDebounced]=useState('');const[page,setPage]=useState(0);const[pageSize,setPageSize]=useState(12);const[totalCount,setTotalCount]=useState(0);const[selected,setSelected]=useState(new Set());const loadLookups=async()=>{try{var _errFloors;const[{data:bs,error:e1}]=await Promise.all([supabase.from('buildings').select('id,name').order('name')]);if(e1)throw e1;setBuildings(bs||[]);// floors: جلب مرن مع محاولات بديلة لتفادي أخطاء ترتيب/أسماء الأعمدة\nlet fs=[];let errFloors=null;try{const{data,error}=await supabase.from('floors').select('id,name,floor_number,number,building_id').order('id');if(error)throw error;fs=data||[];}catch(err){errFloors=err;try{const{data,error}=await supabase.from('floors').select('*');if(error)throw error;fs=data||[];}catch(err2){console.error('Failed floors lookup (fallback also failed)',err2);fs=[];}}if(errFloors)console.warn('Floors initial fetch err:',((_errFloors=errFloors)===null||_errFloors===void 0?void 0:_errFloors.message)||errFloors);setFloors(fs);// room types\ntry{const{data:rts,error}=await supabase.from('room_types_active').select('id,name,name_ar,base_price,max_guests').order('display_order');if(error)throw error;setRoomTypes(rts||[]);}catch(errRt){console.error('Failed room types lookup',errRt);setRoomTypes([]);}}catch(e){console.error('Failed to load lookups',e);}};const buildRoomsQuery=()=>{const q=supabase.from('rooms_overview').select('*',{count:'exact'}).order('room_code',{ascending:true});// حالة البحث\nconst term=(debounced||'').trim();if(term){// البحث عن الرمز أو الوصف\nq.or(\"room_code.ilike.%\".concat(term,\"%,description.ilike.%\").concat(term,\"%\"));}// تصفية الحالة\nconst activeStatuses=Object.entries(statusFilters).filter(_ref=>{let[,v]=_ref;return v;}).map(_ref2=>{let[k]=_ref2;return k;});if(activeStatuses.length>0&&activeStatuses.length<4){q.in('status',activeStatuses);}// تصفية النظافة (إن وُجدت في العرض)\nconst activeClean=Object.entries(cleanFilters).filter(_ref3=>{let[,v]=_ref3;return v;}).map(_ref4=>{let[k]=_ref4;return k;});if(activeClean.length>0&&activeClean.length<3){q.in('cleanliness',activeClean);}// ترقيم الصفحات\nconst from=page*pageSize;const to=from+pageSize-1;q.range(from,to);return q;};const loadRooms=async()=>{setLoading(true);try{const q=buildRoomsQuery();const{data,error,count}=await q;if(error)throw error;setRooms(data||[]);setTotalCount(count||0);}catch(e){console.error('Failed to load rooms',e);setRooms([]);setTotalCount(0);}finally{setLoading(false);}};useEffect(()=>{loadLookups();loadRooms();},[]);// Realtime: auto-refresh on rooms/reservations changes\nuseEffect(()=>{const channel=supabase.channel('rooms-live').on('postgres_changes',{event:'*',schema:'public',table:'rooms'},()=>{loadRooms();}).on('postgres_changes',{event:'*',schema:'public',table:'reservations'},()=>{loadRooms();}).subscribe();return()=>{try{supabase.removeChannel(channel);}catch(_){}};},[]);// debounce للبحث\nuseEffect(()=>{const t=setTimeout(()=>setDebounced(search),350);return()=>clearTimeout(t);},[search]);// إعادة الجلب عند تغيّر عوامل التصفية أو البحث أو الصفحة\nuseEffect(()=>{loadRooms();},[debounced,statusFilters,cleanFilters,page,pageSize]);const filteredRooms=useMemo(()=>{return rooms.filter(r=>{if(filterBuilding!=='all'&&String(r.building_id)!==String(filterBuilding))return false;if(filterFloor!=='all'&&String(r.floor_id)!==String(filterFloor))return false;return true;});},[rooms,filterBuilding,filterFloor]);const counters=useMemo(()=>{const total=filteredRooms.length;const available=filteredRooms.filter(r=>r.status==='available').length;const reserved=filteredRooms.filter(r=>r.status==='reserved').length;const occupied=filteredRooms.filter(r=>r.status==='occupied').length;const maintenance=filteredRooms.filter(r=>r.status==='maintenance').length;return{total,available,reserved,occupied,maintenance};},[filteredRooms]);const openCreate=()=>{setEditing(null);setShowModal(true);};const openEdit=room=>{setEditing(room);setShowModal(true);};const handleDelete=async room=>{try{if(!room||!room.id)return;const confirmText=window.prompt('لتأكيد الحذف اكتب: ok','');if(!confirmText||String(confirmText).trim().toLowerCase()!=='ok'){window.alert('تم إلغاء الحذف.');return;}const{error}=await supabase.from('rooms').delete().eq('id',room.id);if(error)throw error;await loadRooms();}catch(e){console.error('Delete room failed',e);window.alert('تعذّر حذف الغرفة: '+(e.message||e));}};const handleSave=async payload=>{// payload من RoomModal: يحوي القيم المطلوبة فقط\ntry{const cleaned={building_id:payload.building_id,floor_id:payload.floor_id,room_type_id:payload.room_type_id,room_code:(payload.room_code||'').trim(),// دعم جداول لديها room_number إلزامي\nroom_number:(payload.room_code||'').trim(),status:payload.status||'available',cleanliness:payload.cleanliness||'clean',description:payload.description||null,features:Array.isArray(payload.features)?payload.features:String(payload.features||'').split(',').map(s=>s.trim()).filter(Boolean),image_url:payload.image_url||null};const doSave=async()=>{if(editing&&editing.id){return supabase.from('rooms').update(cleaned).eq('id',editing.id);}else{return supabase.from('rooms').insert([cleaned]);}};let{error}=await doSave();if(error){const msg=String(error.message||error).toLowerCase();// لو العمود room_number غير موجود، نحذفه ونعيد المحاولة\nif(msg.includes('room_number')&&msg.includes('does not exist')){delete cleaned.room_number;const res2=await doSave();error=res2.error;}// لو فشل بسبب عمود غير موجود آخر، نحذف الحقل ونحاول\nif(error){const m2=String(error.message||error).toLowerCase();['view_id','room_view_id'].forEach(k=>{if(m2.includes(k))delete cleaned[k];});}if(error)throw error;}setShowModal(false);await loadRooms();}catch(e){console.error('Save room failed',e);window.alert('حصل خطأ أثناء حفظ الغرفة: '+(e.message||e));}};const floorsForBuilding=useMemo(()=>{if(filterBuilding==='all')return floors;const filtered=floors.filter(f=>String(f.building_id)===String(filterBuilding));return filtered.length>0?filtered:floors;},[floors,filterBuilding]);const toggleStatus=key=>setStatusFilters(s=>_objectSpread(_objectSpread({},s),{},{[key]:!s[key]}));const toggleClean=key=>setCleanFilters(s=>_objectSpread(_objectSpread({},s),{},{[key]:!s[key]}));const resetFilters=()=>{setStatusFilters({available:true,reserved:true,occupied:true,maintenance:true});setCleanFilters({clean:true,in_cleaning:true,needs_cleaning:true});setFilterBuilding('all');setFilterFloor('all');setSearch('');setPage(0);};const Chip=_ref5=>{let{active,color,label,count,onClick,title}=_ref5;return/*#__PURE__*/_jsxs(\"button\",{title:title,onClick:onClick,className:\"px-3 py-1 rounded-full text-sm border \".concat(active?\"bg-\".concat(color,\"-100 text-\").concat(color,\"-700 border-\").concat(color,\"-300\"):'bg-white text-gray-600 border-gray-200',\" hover:bg-gray-100\"),children:[/*#__PURE__*/_jsx(\"span\",{className:\"ml-2\",children:label}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-[1px] rounded text-xs \".concat(active?\"bg-\".concat(color,\"-200 text-\").concat(color,\"-800\"):'bg-gray-200 text-gray-700'),children:count})]});};const selectedCount=selected.size;const toggleSelect=id=>{setSelected(prev=>{const next=new Set(prev);if(next.has(id))next.delete(id);else next.add(id);return next;});};const allVisibleSelected=useMemo(()=>{if(filteredRooms.length===0)return false;return filteredRooms.every(r=>selected.has(r.id));},[filteredRooms,selected]);const toggleSelectAllVisible=checked=>{setSelected(prev=>{const next=new Set(prev);if(checked){filteredRooms.forEach(r=>next.add(r.id));}else{filteredRooms.forEach(r=>next.delete(r.id));}return next;});};const bulkUpdate=async(field,value)=>{if(selected.size===0)return;try{const ids=Array.from(selected);const{error}=await supabase.from('rooms').update({[field]:value}).in('id',ids);if(error)throw error;setSelected(new Set());await loadRooms();}catch(e){console.error('Bulk update failed',e);window.alert('تعذّر تنفيذ الإجراء الجماعي: '+(e.message||e));}};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-8\",dir:\"rtl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold\",children:\"\\u0625\\u062F\\u0627\\u0631\\u0629 \\u0627\\u0644\\u063A\\u0631\\u0641\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"\\u0646\\u0638\\u0627\\u0645 \\u0645\\u062A\\u0643\\u0627\\u0645\\u0644 \\u0644\\u0625\\u062F\\u0627\\u0631\\u0629 \\u0627\\u0644\\u063A\\u0631\\u0641 \\u0645\\u0639 \\u0627\\u0644\\u0639\\u062F\\u0651\\u0627\\u062F\\u0627\\u062A \\u0648\\u0627\\u0644\\u062A\\u0635\\u0641\\u064A\\u0627\\u062A\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:openCreate,className:\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded\",children:\"\\u0625\\u0636\\u0627\\u0641\\u0629 \\u063A\\u0631\\u0641\\u0629 \\u062C\\u062F\\u064A\\u062F\\u0629 +\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded shadow p-4 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"\\u0635\\u064A\\u0627\\u0646\\u0629\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-red-600\",children:counters.maintenance})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded shadow p-4 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"\\u0645\\u062D\\u062C\\u0648\\u0632\\u0629\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-amber-600\",children:counters.reserved})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded shadow p-4 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"\\u0645\\u0634\\u063A\\u0648\\u0644\\u0629\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-pink-600\",children:counters.occupied})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded shadow p-4 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"\\u0645\\u062A\\u0627\\u062D\\u0629\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600\",children:counters.available})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded shadow p-4 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:counters.total})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-3 mb-4\",children:[/*#__PURE__*/_jsxs(\"select\",{className:\"border rounded px-3 py-2\",value:filterBuilding,onChange:e=>setFilterBuilding(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"\\u0643\\u0644 \\u0627\\u0644\\u0645\\u0628\\u0627\\u0646\\u064A\"}),buildings.map(b=>/*#__PURE__*/_jsx(\"option\",{value:b.id,children:b.name},b.id))]}),/*#__PURE__*/_jsxs(\"select\",{className:\"border rounded px-3 py-2\",value:filterFloor,onChange:e=>setFilterFloor(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"\\u0643\\u0644 \\u0627\\u0644\\u0637\\u0648\\u0627\\u0628\\u0642\"}),floorsForBuilding.map(f=>{const label=f.name||f.floor_name||(f.floor_number?\"\\u0627\\u0644\\u0637\\u0627\\u0628\\u0642 \".concat(f.floor_number):f.number?\"\\u0627\\u0644\\u0637\\u0627\\u0628\\u0642 \".concat(f.number):\"\\u0637\\u0627\\u0628\\u0642 #\".concat(f.id));return/*#__PURE__*/_jsx(\"option\",{value:f.id,children:label},f.id);})]}),/*#__PURE__*/_jsx(\"input\",{className:\"border rounded px-3 py-2 flex-1 min-w-[180px]\",placeholder:\"\\u0628\\u062D\\u062B: \\u0631\\u0642\\u0645/\\u0648\\u0635\\u0641 \\u0627\\u0644\\u063A\\u0631\\u0641\\u0629\",value:search,onChange:e=>{setSearch(e.target.value);setPage(0);}}),/*#__PURE__*/_jsx(\"button\",{className:\"border rounded px-3 py-2 text-gray-700 hover:bg-gray-100\",onClick:resetFilters,children:\"\\u0625\\u0639\\u0627\\u062F\\u0629 \\u0636\\u0628\\u0637\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-2 mb-6\",children:[/*#__PURE__*/_jsx(Chip,{title:\"\\u062D\\u0627\\u0644\\u0629: \\u0645\\u062A\\u0627\\u062D\\u0629\",active:statusFilters.available,color:\"green\",label:\"\\u0645\\u062A\\u0627\\u062D\\u0629\",count:filteredRooms.filter(r=>r.status==='available').length,onClick:()=>toggleStatus('available')}),/*#__PURE__*/_jsx(Chip,{title:\"\\u062D\\u0627\\u0644\\u0629: \\u0645\\u062D\\u062C\\u0648\\u0632\\u0629\",active:statusFilters.reserved,color:\"amber\",label:\"\\u0645\\u062D\\u062C\\u0648\\u0632\\u0629\",count:filteredRooms.filter(r=>r.status==='reserved').length,onClick:()=>toggleStatus('reserved')}),/*#__PURE__*/_jsx(Chip,{title:\"\\u062D\\u0627\\u0644\\u0629: \\u0645\\u0634\\u063A\\u0648\\u0644\\u0629\",active:statusFilters.occupied,color:\"pink\",label:\"\\u0645\\u0634\\u063A\\u0648\\u0644\\u0629\",count:filteredRooms.filter(r=>r.status==='occupied').length,onClick:()=>toggleStatus('occupied')}),/*#__PURE__*/_jsx(Chip,{title:\"\\u062D\\u0627\\u0644\\u0629: \\u0635\\u064A\\u0627\\u0646\\u0629\",active:statusFilters.maintenance,color:\"red\",label:\"\\u0635\\u064A\\u0627\\u0646\\u0629\",count:filteredRooms.filter(r=>r.status==='maintenance').length,onClick:()=>toggleStatus('maintenance')}),/*#__PURE__*/_jsx(\"span\",{className:\"mx-2 text-gray-400\",children:\"|\"}),/*#__PURE__*/_jsx(Chip,{title:\"\\u0646\\u0638\\u0627\\u0641\\u0629: \\u0646\\u0638\\u064A\\u0641\\u0629\",active:cleanFilters.clean,color:\"green\",label:\"\\u0646\\u0638\\u064A\\u0641\\u0629\",count:filteredRooms.filter(r=>r.cleanliness==='clean').length,onClick:()=>toggleClean('clean')}),/*#__PURE__*/_jsx(Chip,{title:\"\\u0646\\u0638\\u0627\\u0641\\u0629: \\u062C\\u0627\\u0631\\u064A \\u062A\\u0646\\u0638\\u064A\\u0641\",active:cleanFilters.in_cleaning,color:\"amber\",label:\"\\u062C\\u0627\\u0631\\u064A \\u062A\\u0646\\u0638\\u064A\\u0641\",count:filteredRooms.filter(r=>r.cleanliness==='in_cleaning').length,onClick:()=>toggleClean('in_cleaning')}),/*#__PURE__*/_jsx(Chip,{title:\"\\u0646\\u0638\\u0627\\u0641\\u0629: \\u062A\\u062D\\u062A\\u0627\\u062C \\u0646\\u0638\\u0627\\u0641\\u0629\",active:cleanFilters.needs_cleaning,color:\"red\",label:\"\\u062A\\u062D\\u062A\\u0627\\u062C \\u0646\\u0638\\u0627\\u0641\\u0629\",count:filteredRooms.filter(r=>r.cleanliness==='needs_cleaning').length,onClick:()=>toggleClean('needs_cleaning')})]}),!loading&&filteredRooms.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:allVisibleSelected,onChange:e=>toggleSelectAllVisible(e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-700\",children:\"\\u062A\\u062D\\u062F\\u064A\\u062F \\u0627\\u0644\\u0643\\u0644 (\\u0627\\u0644\\u0639\\u0646\\u0627\\u0635\\u0631 \\u0627\\u0644\\u0638\\u0627\\u0647\\u0631\\u0629)\"})]}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6\",children:Array.from({length:6}).map((_,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-1 bg-gray-200\"}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 pt-4 h-6 bg-gray-100 mb-2\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 pb-4 space-y-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-100\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-100 w-2/3\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-100 w-1/2\"})]})]},i))}):filteredRooms.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 bg-white rounded shadow flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-lg font-semibold mb-1\",children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0646\\u062A\\u0627\\u0626\\u062C \\u0645\\u0637\\u0627\\u0628\\u0642\\u0629\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-600\",children:\"\\u062C\\u0631\\u0651\\u0628 \\u062A\\u0639\\u062F\\u064A\\u0644 \\u0639\\u0648\\u0627\\u0645\\u0644 \\u0627\\u0644\\u0628\\u062D\\u062B \\u0623\\u0648 \\u0623\\u0636\\u0641 \\u063A\\u0631\\u0641\\u0629 \\u062C\\u062F\\u064A\\u062F\\u0629.\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:openCreate,className:\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded\",children:\"\\u0625\\u0636\\u0627\\u0641\\u0629 \\u063A\\u0631\\u0641\\u0629\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6\",children:filteredRooms.map(r=>/*#__PURE__*/_jsx(RoomCard,{room:r,onEdit:()=>openEdit(r),onDelete:()=>handleDelete(r),onSelect:()=>toggleSelect(r.id),selected:selected.has(r.id)},r.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[\"\\u0627\\u0644\\u0646\\u062A\\u0627\\u0626\\u062C: \",rooms.length,\" / \\u0627\\u0644\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A: \",totalCount]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-3 py-1 border rounded\",onClick:()=>setPage(p=>Math.max(0,p-1)),disabled:page===0,children:\"\\u0627\\u0644\\u0633\\u0627\\u0628\\u0642\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[\"\\u0635\\u0641\\u062D\\u0629 \",page+1]}),/*#__PURE__*/_jsx(\"button\",{className:\"px-3 py-1 border rounded\",onClick:()=>setPage(p=>p+1),disabled:(page+1)*pageSize>=totalCount,children:\"\\u0627\\u0644\\u062A\\u0627\\u0644\\u064A\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"border rounded px-2 py-1\",value:pageSize,onChange:e=>{setPageSize(Number(e.target.value));setPage(0);},children:[/*#__PURE__*/_jsx(\"option\",{value:6,children:\"6\"}),/*#__PURE__*/_jsx(\"option\",{value:12,children:\"12\"}),/*#__PURE__*/_jsx(\"option\",{value:24,children:\"24\"})]})]})]}),selectedCount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-6 right-6 bg-white border shadow-lg rounded p-3 flex items-center gap-2\",dir:\"rtl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-700\",children:[\"\\u0627\\u0644\\u0645\\u062D\\u062F\\u062F: \",selectedCount]}),/*#__PURE__*/_jsxs(\"select\",{className:\"border rounded px-2 py-1\",onChange:e=>{const v=e.target.value;if(v)bulkUpdate('status',v);e.target.value='';},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u062A\\u063A\\u064A\\u064A\\u0631 \\u0627\\u0644\\u062D\\u0627\\u0644\\u0629...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"available\",children:\"\\u0645\\u062A\\u0627\\u062D\\u0629\"}),/*#__PURE__*/_jsx(\"option\",{value:\"reserved\",children:\"\\u0645\\u062D\\u062C\\u0648\\u0632\\u0629\"}),/*#__PURE__*/_jsx(\"option\",{value:\"occupied\",children:\"\\u0645\\u0634\\u063A\\u0648\\u0644\\u0629\"}),/*#__PURE__*/_jsx(\"option\",{value:\"maintenance\",children:\"\\u0635\\u064A\\u0627\\u0646\\u0629\"})]}),/*#__PURE__*/_jsxs(\"select\",{className:\"border rounded px-2 py-1\",onChange:e=>{const v=e.target.value;if(v)bulkUpdate('cleanliness',v);e.target.value='';},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u062A\\u063A\\u064A\\u064A\\u0631 \\u0627\\u0644\\u0646\\u0638\\u0627\\u0641\\u0629...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"clean\",children:\"\\u0646\\u0638\\u064A\\u0641\\u0629\"}),/*#__PURE__*/_jsx(\"option\",{value:\"in_cleaning\",children:\"\\u062C\\u0627\\u0631\\u064A \\u062A\\u0646\\u0638\\u064A\\u0641\"}),/*#__PURE__*/_jsx(\"option\",{value:\"needs_cleaning\",children:\"\\u062A\\u062D\\u062A\\u0627\\u062C \\u0646\\u0638\\u0627\\u0641\\u0629\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"border rounded px-2 py-1\",onClick:()=>setSelected(new Set()),children:\"\\u0625\\u0644\\u063A\\u0627\\u0621 \\u0627\\u0644\\u062A\\u062D\\u062F\\u064A\\u062F\"})]}),showModal&&/*#__PURE__*/_jsx(RoomModal,{initialData:editing,buildings:buildings,floors:floors,roomTypes:roomTypes,onClose:()=>setShowModal(false),onSave:handleSave})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useState","supabase","RoomModal","RoomCard","jsx","_jsx","jsxs","_jsxs","Rooms","rooms","setRooms","loading","setLoading","showModal","setShowModal","editing","setEditing","buildings","setBuildings","floors","setFloors","roomTypes","setRoomTypes","filterBuilding","setFilterBuilding","filterFloor","setFilterFloor","statusFilters","setStatusFilters","available","reserved","occupied","maintenance","cleanFilters","setCleanFilters","clean","in_cleaning","needs_cleaning","search","setSearch","debounced","setDebounced","page","setPage","pageSize","setPageSize","totalCount","setTotalCount","selected","setSelected","Set","loadLookups","_errFloors","data","bs","error","e1","Promise","all","from","select","order","fs","errFloors","err","err2","console","warn","message","rts","errRt","e","buildRoomsQuery","q","count","ascending","term","trim","or","concat","activeStatuses","Object","entries","filter","_ref","v","map","_ref2","k","length","in","activeClean","_ref3","_ref4","to","range","loadRooms","channel","on","event","schema","table","subscribe","removeChannel","_","t","setTimeout","clearTimeout","filteredRooms","r","String","building_id","floor_id","counters","total","status","openCreate","openEdit","room","handleDelete","id","confirmText","window","prompt","toLowerCase","alert","delete","eq","handleSave","payload","cleaned","room_type_id","room_code","room_number","cleanliness","description","features","Array","isArray","split","s","Boolean","image_url","doSave","update","insert","msg","includes","res2","m2","forEach","floorsForBuilding","filtered","f","toggleStatus","key","_objectSpread","toggleClean","resetFilters","Chip","_ref5","active","color","label","onClick","title","className","children","selectedCount","size","toggleSelect","prev","next","has","add","allVisibleSelected","every","toggleSelectAllVisible","checked","bulkUpdate","field","value","ids","dir","onChange","target","b","name","floor_name","floor_number","number","placeholder","type","i","onEdit","onDelete","onSelect","p","Math","max","disabled","Number","initialData","onClose","onSave"],"sources":["F:/kelany/src/pages/Rooms.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { supabase } from '../supabaseClient';\r\nimport RoomModal from '../components/RoomModal';\r\nimport RoomCard from '../components/RoomCard';\r\n\r\nexport default function Rooms() {\r\n  const [rooms, setRooms] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [editing, setEditing] = useState(null);\r\n  const [buildings, setBuildings] = useState([]);\r\n  const [floors, setFloors] = useState([]);\r\n  const [roomTypes, setRoomTypes] = useState([]);\r\n  const [filterBuilding, setFilterBuilding] = useState('all');\r\n  const [filterFloor, setFilterFloor] = useState('all');\r\n  const [statusFilters, setStatusFilters] = useState({ available: true, reserved: true, occupied: true, maintenance: true });\r\n  const [cleanFilters, setCleanFilters] = useState({ clean: true, in_cleaning: true, needs_cleaning: true });\r\n  const [search, setSearch] = useState('');\r\n  const [debounced, setDebounced] = useState('');\r\n  const [page, setPage] = useState(0);\r\n  const [pageSize, setPageSize] = useState(12);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [selected, setSelected] = useState(new Set());\r\n\r\n  const loadLookups = async () => {\r\n    try {\r\n      const [{ data: bs, error: e1 }] = await Promise.all([\r\n        supabase.from('buildings').select('id,name').order('name')\r\n      ]);\r\n      if (e1) throw e1;\r\n      setBuildings(bs || []);\r\n\r\n      // floors: جلب مرن مع محاولات بديلة لتفادي أخطاء ترتيب/أسماء الأعمدة\r\n      let fs = [];\r\n      let errFloors = null;\r\n      try {\r\n        const { data, error } = await supabase\r\n          .from('floors')\r\n          .select('id,name,floor_number,number,building_id')\r\n          .order('id');\r\n        if (error) throw error;\r\n        fs = data || [];\r\n      } catch (err) {\r\n        errFloors = err;\r\n        try {\r\n          const { data, error } = await supabase\r\n            .from('floors')\r\n            .select('*');\r\n          if (error) throw error;\r\n          fs = data || [];\r\n        } catch (err2) {\r\n          console.error('Failed floors lookup (fallback also failed)', err2);\r\n          fs = [];\r\n        }\r\n      }\r\n      if (errFloors) console.warn('Floors initial fetch err:', errFloors?.message || errFloors);\r\n      setFloors(fs);\r\n\r\n      // room types\r\n      try {\r\n        const { data: rts, error } = await supabase\r\n          .from('room_types_active')\r\n          .select('id,name,name_ar,base_price,max_guests')\r\n          .order('display_order');\r\n        if (error) throw error;\r\n        setRoomTypes(rts || []);\r\n      } catch (errRt) {\r\n        console.error('Failed room types lookup', errRt);\r\n        setRoomTypes([]);\r\n      }\r\n    } catch (e) {\r\n      console.error('Failed to load lookups', e);\r\n    }\r\n  };\r\n\r\n  const buildRoomsQuery = () => {\r\n    const q = supabase\r\n      .from('rooms_overview')\r\n      .select('*', { count: 'exact' })\r\n      .order('room_code', { ascending: true });\r\n\r\n    // حالة البحث\r\n    const term = (debounced || '').trim();\r\n    if (term) {\r\n      // البحث عن الرمز أو الوصف\r\n      q.or(`room_code.ilike.%${term}%,description.ilike.%${term}%`);\r\n    }\r\n\r\n    // تصفية الحالة\r\n    const activeStatuses = Object.entries(statusFilters).filter(([,v])=>v).map(([k])=>k);\r\n    if (activeStatuses.length > 0 && activeStatuses.length < 4) {\r\n      q.in('status', activeStatuses);\r\n    }\r\n\r\n    // تصفية النظافة (إن وُجدت في العرض)\r\n    const activeClean = Object.entries(cleanFilters).filter(([,v])=>v).map(([k])=>k);\r\n    if (activeClean.length > 0 && activeClean.length < 3) {\r\n      q.in('cleanliness', activeClean);\r\n    }\r\n\r\n    // ترقيم الصفحات\r\n    const from = page * pageSize;\r\n    const to = from + pageSize - 1;\r\n    q.range(from, to);\r\n    return q;\r\n  };\r\n\r\n  const loadRooms = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const q = buildRoomsQuery();\r\n      const { data, error, count } = await q;\r\n      if (error) throw error;\r\n      setRooms(data || []);\r\n      setTotalCount(count || 0);\r\n    } catch (e) {\r\n      console.error('Failed to load rooms', e);\r\n      setRooms([]);\r\n      setTotalCount(0);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadLookups();\r\n    loadRooms();\r\n  }, []);\r\n\r\n  // Realtime: auto-refresh on rooms/reservations changes\r\n  useEffect(() => {\r\n    const channel = supabase.channel('rooms-live')\r\n      .on('postgres_changes', { event: '*', schema: 'public', table: 'rooms' }, () => {\r\n        loadRooms();\r\n      })\r\n      .on('postgres_changes', { event: '*', schema: 'public', table: 'reservations' }, () => {\r\n        loadRooms();\r\n      })\r\n      .subscribe();\r\n    return () => { try { supabase.removeChannel(channel); } catch(_) {} };\r\n  }, []);\r\n\r\n  // debounce للبحث\r\n  useEffect(() => {\r\n    const t = setTimeout(() => setDebounced(search), 350);\r\n    return () => clearTimeout(t);\r\n  }, [search]);\r\n\r\n  // إعادة الجلب عند تغيّر عوامل التصفية أو البحث أو الصفحة\r\n  useEffect(() => {\r\n    loadRooms();\r\n  }, [debounced, statusFilters, cleanFilters, page, pageSize]);\r\n\r\n  const filteredRooms = useMemo(() => {\r\n    return rooms.filter(r => {\r\n      if (filterBuilding !== 'all' && String(r.building_id) !== String(filterBuilding)) return false;\r\n      if (filterFloor !== 'all' && String(r.floor_id) !== String(filterFloor)) return false;\r\n      return true;\r\n    });\r\n  }, [rooms, filterBuilding, filterFloor]);\r\n\r\n  const counters = useMemo(() => {\r\n    const total = filteredRooms.length;\r\n    const available = filteredRooms.filter(r => r.status === 'available').length;\r\n    const reserved = filteredRooms.filter(r => r.status === 'reserved').length;\r\n    const occupied = filteredRooms.filter(r => r.status === 'occupied').length;\r\n    const maintenance = filteredRooms.filter(r => r.status === 'maintenance').length;\r\n    return { total, available, reserved, occupied, maintenance };\r\n  }, [filteredRooms]);\r\n\r\n  const openCreate = () => { setEditing(null); setShowModal(true); };\r\n  const openEdit = (room) => { setEditing(room); setShowModal(true); };\r\n\r\n  const handleDelete = async (room) => {\r\n    try {\r\n      if (!room || !room.id) return;\r\n      const confirmText = window.prompt('لتأكيد الحذف اكتب: ok', '');\r\n      if (!confirmText || String(confirmText).trim().toLowerCase() !== 'ok') {\r\n        window.alert('تم إلغاء الحذف.');\r\n        return;\r\n      }\r\n      const { error } = await supabase.from('rooms').delete().eq('id', room.id);\r\n      if (error) throw error;\r\n      await loadRooms();\r\n    } catch (e) {\r\n      console.error('Delete room failed', e);\r\n      window.alert('تعذّر حذف الغرفة: ' + (e.message || e));\r\n    }\r\n  };\r\n\r\n  const handleSave = async (payload) => {\r\n    // payload من RoomModal: يحوي القيم المطلوبة فقط\r\n    try {\r\n      const cleaned = {\r\n        building_id: payload.building_id,\r\n        floor_id: payload.floor_id,\r\n        room_type_id: payload.room_type_id,\r\n        room_code: (payload.room_code || '').trim(),\r\n        // دعم جداول لديها room_number إلزامي\r\n        room_number: (payload.room_code || '').trim(),\r\n        status: payload.status || 'available',\r\n        cleanliness: payload.cleanliness || 'clean',\r\n        description: payload.description || null,\r\n        features: Array.isArray(payload.features)\r\n          ? payload.features\r\n          : String(payload.features || '')\r\n              .split(',')\r\n              .map(s => s.trim())\r\n              .filter(Boolean),\r\n        image_url: payload.image_url || null,\r\n      };\r\n\r\n      const doSave = async () => {\r\n        if (editing && editing.id) {\r\n          return supabase.from('rooms').update(cleaned).eq('id', editing.id);\r\n        } else {\r\n          return supabase.from('rooms').insert([cleaned]);\r\n        }\r\n      };\r\n\r\n      let { error } = await doSave();\r\n      if (error) {\r\n        const msg = String(error.message || error).toLowerCase();\r\n        // لو العمود room_number غير موجود، نحذفه ونعيد المحاولة\r\n        if (msg.includes('room_number') && msg.includes('does not exist')) {\r\n          delete cleaned.room_number;\r\n          const res2 = await doSave();\r\n          error = res2.error;\r\n        }\r\n        // لو فشل بسبب عمود غير موجود آخر، نحذف الحقل ونحاول\r\n        if (error) {\r\n          const m2 = String(error.message || error).toLowerCase();\r\n          ['view_id','room_view_id'].forEach(k => { if (m2.includes(k)) delete cleaned[k]; });\r\n        }\r\n        if (error) throw error;\r\n      }\r\n      setShowModal(false);\r\n      await loadRooms();\r\n    } catch (e) {\r\n      console.error('Save room failed', e);\r\n      window.alert('حصل خطأ أثناء حفظ الغرفة: ' + (e.message || e));\r\n    }\r\n  };\r\n\r\n  const floorsForBuilding = useMemo(() => {\r\n    if (filterBuilding === 'all') return floors;\r\n    const filtered = floors.filter(f => String(f.building_id) === String(filterBuilding));\r\n    return filtered.length > 0 ? filtered : floors;\r\n  }, [floors, filterBuilding]);\r\n\r\n  const toggleStatus = (key) => setStatusFilters(s => ({ ...s, [key]: !s[key] }));\r\n  const toggleClean = (key) => setCleanFilters(s => ({ ...s, [key]: !s[key] }));\r\n  const resetFilters = () => {\r\n    setStatusFilters({ available: true, reserved: true, occupied: true, maintenance: true });\r\n    setCleanFilters({ clean: true, in_cleaning: true, needs_cleaning: true });\r\n    setFilterBuilding('all');\r\n    setFilterFloor('all');\r\n    setSearch('');\r\n    setPage(0);\r\n  };\r\n\r\n  const Chip = ({ active, color, label, count, onClick, title }) => (\r\n    <button\r\n      title={title}\r\n      onClick={onClick}\r\n      className={`px-3 py-1 rounded-full text-sm border ${active ? `bg-${color}-100 text-${color}-700 border-${color}-300` : 'bg-white text-gray-600 border-gray-200'} hover:bg-gray-100`}\r\n    >\r\n      <span className=\"ml-2\">{label}</span>\r\n      <span className={`px-2 py-[1px] rounded text-xs ${active ? `bg-${color}-200 text-${color}-800` : 'bg-gray-200 text-gray-700'}`}>{count}</span>\r\n    </button>\r\n  );\r\n\r\n  const selectedCount = selected.size;\r\n  const toggleSelect = (id) => {\r\n    setSelected(prev => {\r\n      const next = new Set(prev);\r\n      if (next.has(id)) next.delete(id); else next.add(id);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const allVisibleSelected = useMemo(() => {\r\n    if (filteredRooms.length === 0) return false;\r\n    return filteredRooms.every(r => selected.has(r.id));\r\n  }, [filteredRooms, selected]);\r\n\r\n  const toggleSelectAllVisible = (checked) => {\r\n    setSelected(prev => {\r\n      const next = new Set(prev);\r\n      if (checked) {\r\n        filteredRooms.forEach(r => next.add(r.id));\r\n      } else {\r\n        filteredRooms.forEach(r => next.delete(r.id));\r\n      }\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const bulkUpdate = async (field, value) => {\r\n    if (selected.size === 0) return;\r\n    try {\r\n      const ids = Array.from(selected);\r\n      const { error } = await supabase.from('rooms').update({ [field]: value }).in('id', ids);\r\n      if (error) throw error;\r\n      setSelected(new Set());\r\n      await loadRooms();\r\n    } catch (e) {\r\n      console.error('Bulk update failed', e);\r\n      window.alert('تعذّر تنفيذ الإجراء الجماعي: ' + (e.message || e));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-8\" dir=\"rtl\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold\">إدارة الغرف</h2>\r\n          <p className=\"text-sm text-gray-500\">نظام متكامل لإدارة الغرف مع العدّادات والتصفيات</p>\r\n        </div>\r\n        <button onClick={openCreate} className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded\">إضافة غرفة جديدة +</button>\r\n      </div>\r\n\r\n      {/* Counters */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6\">\r\n        <div className=\"bg-white rounded shadow p-4 text-center\">\r\n          <div className=\"text-sm text-gray-500\">صيانة</div>\r\n          <div className=\"text-2xl font-bold text-red-600\">{counters.maintenance}</div>\r\n        </div>\r\n        <div className=\"bg-white rounded shadow p-4 text-center\">\r\n          <div className=\"text-sm text-gray-500\">محجوزة</div>\r\n          <div className=\"text-2xl font-bold text-amber-600\">{counters.reserved}</div>\r\n        </div>\r\n        <div className=\"bg-white rounded shadow p-4 text-center\">\r\n          <div className=\"text-sm text-gray-500\">مشغولة</div>\r\n          <div className=\"text-2xl font-bold text-pink-600\">{counters.occupied}</div>\r\n        </div>\r\n        <div className=\"bg-white rounded shadow p-4 text-center\">\r\n          <div className=\"text-sm text-gray-500\">متاحة</div>\r\n          <div className=\"text-2xl font-bold text-green-600\">{counters.available}</div>\r\n        </div>\r\n        <div className=\"bg-white rounded shadow p-4 text-center\">\r\n          <div className=\"text-sm text-gray-500\">إجمالي</div>\r\n          <div className=\"text-2xl font-bold text-blue-600\">{counters.total}</div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"flex flex-wrap items-center gap-3 mb-4\">\r\n        <select className=\"border rounded px-3 py-2\" value={filterBuilding} onChange={e=>setFilterBuilding(e.target.value)}>\r\n          <option value=\"all\">كل المباني</option>\r\n          {buildings.map(b => <option key={b.id} value={b.id}>{b.name}</option>)}\r\n        </select>\r\n        <select className=\"border rounded px-3 py-2\" value={filterFloor} onChange={e=>setFilterFloor(e.target.value)}>\r\n          <option value=\"all\">كل الطوابق</option>\r\n          {floorsForBuilding.map(f => {\r\n            const label = f.name || f.floor_name || (f.floor_number ? `الطابق ${f.floor_number}` : (f.number ? `الطابق ${f.number}` : `طابق #${f.id}`));\r\n            return <option key={f.id} value={f.id}>{label}</option>;\r\n          })}\r\n        </select>\r\n        <input\r\n          className=\"border rounded px-3 py-2 flex-1 min-w-[180px]\"\r\n          placeholder=\"بحث: رقم/وصف الغرفة\"\r\n          value={search}\r\n          onChange={e=>{ setSearch(e.target.value); setPage(0); }}\r\n        />\r\n        <button className=\"border rounded px-3 py-2 text-gray-700 hover:bg-gray-100\" onClick={resetFilters}>إعادة ضبط</button>\r\n      </div>\r\n\r\n      {/* Smart filter chips */}\r\n      <div className=\"flex flex-wrap items-center gap-2 mb-6\">\r\n        <Chip title=\"حالة: متاحة\" active={statusFilters.available} color=\"green\" label=\"متاحة\" count={filteredRooms.filter(r=>r.status==='available').length} onClick={()=>toggleStatus('available')} />\r\n        <Chip title=\"حالة: محجوزة\" active={statusFilters.reserved} color=\"amber\" label=\"محجوزة\" count={filteredRooms.filter(r=>r.status==='reserved').length} onClick={()=>toggleStatus('reserved')} />\r\n        <Chip title=\"حالة: مشغولة\" active={statusFilters.occupied} color=\"pink\" label=\"مشغولة\" count={filteredRooms.filter(r=>r.status==='occupied').length} onClick={()=>toggleStatus('occupied')} />\r\n        <Chip title=\"حالة: صيانة\" active={statusFilters.maintenance} color=\"red\" label=\"صيانة\" count={filteredRooms.filter(r=>r.status==='maintenance').length} onClick={()=>toggleStatus('maintenance')} />\r\n        <span className=\"mx-2 text-gray-400\">|</span>\r\n        <Chip title=\"نظافة: نظيفة\" active={cleanFilters.clean} color=\"green\" label=\"نظيفة\" count={filteredRooms.filter(r=>r.cleanliness==='clean').length} onClick={()=>toggleClean('clean')} />\r\n        <Chip title=\"نظافة: جاري تنظيف\" active={cleanFilters.in_cleaning} color=\"amber\" label=\"جاري تنظيف\" count={filteredRooms.filter(r=>r.cleanliness==='in_cleaning').length} onClick={()=>toggleClean('in_cleaning')} />\r\n        <Chip title=\"نظافة: تحتاج نظافة\" active={cleanFilters.needs_cleaning} color=\"red\" label=\"تحتاج نظافة\" count={filteredRooms.filter(r=>r.cleanliness==='needs_cleaning').length} onClick={()=>toggleClean('needs_cleaning')} />\r\n      </div>\r\n\r\n      {/* Select all toolbar */}\r\n      {!loading && filteredRooms.length > 0 && (\r\n        <div className=\"flex items-center gap-2 mb-3\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={allVisibleSelected}\r\n            onChange={(e)=>toggleSelectAllVisible(e.target.checked)}\r\n          />\r\n          <span className=\"text-sm text-gray-700\">تحديد الكل (العناصر الظاهرة)</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Grid */}\r\n      {loading ? (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6\">\r\n          {Array.from({ length: 6 }).map((_, i) => (\r\n            <div key={i} className=\"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden animate-pulse\">\r\n              <div className=\"h-1 bg-gray-200\" />\r\n              <div className=\"px-4 pt-4 h-6 bg-gray-100 mb-2\" />\r\n              <div className=\"px-4 pb-4 space-y-2\">\r\n                <div className=\"h-4 bg-gray-100\" />\r\n                <div className=\"h-4 bg-gray-100 w-2/3\" />\r\n                <div className=\"h-4 bg-gray-100 w-1/2\" />\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ) : filteredRooms.length === 0 ? (\r\n        <div className=\"p-6 bg-white rounded shadow flex items-center justify-between\">\r\n          <div>\r\n            <div className=\"text-lg font-semibold mb-1\">لا توجد نتائج مطابقة</div>\r\n            <div className=\"text-gray-600\">جرّب تعديل عوامل البحث أو أضف غرفة جديدة.</div>\r\n          </div>\r\n          <button onClick={openCreate} className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded\">إضافة غرفة</button>\r\n        </div>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6\">\r\n          {filteredRooms.map(r => (\r\n            <RoomCard\r\n              key={r.id}\r\n              room={r}\r\n              onEdit={() => openEdit(r)}\r\n              onDelete={() => handleDelete(r)}\r\n              onSelect={() => toggleSelect(r.id)}\r\n              selected={selected.has(r.id)}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Pagination */}\r\n      <div className=\"flex items-center justify-between mt-6\">\r\n        <div className=\"text-sm text-gray-600\">النتائج: {rooms.length} / الإجمالي: {totalCount}</div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <button className=\"px-3 py-1 border rounded\" onClick={()=>setPage(p=>Math.max(0,p-1))} disabled={page===0}>السابق</button>\r\n          <span className=\"text-sm\">صفحة {page+1}</span>\r\n          <button className=\"px-3 py-1 border rounded\" onClick={()=>setPage(p=>p+1)} disabled={(page+1)*pageSize>=totalCount}>التالي</button>\r\n          <select className=\"border rounded px-2 py-1\" value={pageSize} onChange={e=>{ setPageSize(Number(e.target.value)); setPage(0); }}>\r\n            <option value={6}>6</option>\r\n            <option value={12}>12</option>\r\n            <option value={24}>24</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Bulk actions */}\r\n      {selectedCount > 0 && (\r\n        <div className=\"fixed bottom-6 right-6 bg-white border shadow-lg rounded p-3 flex items-center gap-2\" dir=\"rtl\">\r\n          <div className=\"text-sm text-gray-700\">المحدد: {selectedCount}</div>\r\n          <select className=\"border rounded px-2 py-1\" onChange={e=>{ const v=e.target.value; if (v) bulkUpdate('status', v); e.target.value=''; }}>\r\n            <option value=\"\">تغيير الحالة...</option>\r\n            <option value=\"available\">متاحة</option>\r\n            <option value=\"reserved\">محجوزة</option>\r\n            <option value=\"occupied\">مشغولة</option>\r\n            <option value=\"maintenance\">صيانة</option>\r\n          </select>\r\n          <select className=\"border rounded px-2 py-1\" onChange={e=>{ const v=e.target.value; if (v) bulkUpdate('cleanliness', v); e.target.value=''; }}>\r\n            <option value=\"\">تغيير النظافة...</option>\r\n            <option value=\"clean\">نظيفة</option>\r\n            <option value=\"in_cleaning\">جاري تنظيف</option>\r\n            <option value=\"needs_cleaning\">تحتاج نظافة</option>\r\n          </select>\r\n          <button className=\"border rounded px-2 py-1\" onClick={()=>setSelected(new Set())}>إلغاء التحديد</button>\r\n        </div>\r\n      )}\r\n\r\n      {showModal && (\r\n        <RoomModal\r\n          initialData={editing}\r\n          buildings={buildings}\r\n          floors={floors}\r\n          roomTypes={roomTypes}\r\n          onClose={() => setShowModal(false)}\r\n          onSave={handleSave}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}