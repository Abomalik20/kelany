{"ast":null,"code":"import React,{useEffect,useMemo,useState}from'react';import{supabase}from'../supabaseClient';import{getReservationStatusColor,getReservationStatusLabelAr,ReservationStatus}from'../utils/status';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const daysOfWeek=startDate=>{const days=[];const d=new Date(startDate);for(let i=0;i<7;i++){const di=new Date(d);di.setDate(d.getDate()+i);days.push(di);}return days;};const statusColor=s=>{const v=String(s||'').toLowerCase();if(v==='pending')return'#f59e0b';if(v==='confirmed')return'#10b981';if(v==='checked_in')return'#3b82f6';if(v==='checked_out')return'#6b7280';if(v==='canceled'||v==='cancelled')return'#ef4444';if(v==='no_show')return'#f59e0b';return'#9ca3af';};const statusLabelAr=s=>{const v=String(s||'').toLowerCase();if(v==='pending')return'قيد الانتظار';if(v==='confirmed')return'مؤكد';if(v==='checked_in')return'تم الدخول';if(v==='checked_out')return'تم الخروج';if(v==='canceled'||v==='cancelled')return'ملغي';if(v==='no_show')return'لم يحضر';return'غير معروف';};export default function Calendar(_ref){let{selectedDate,onDateChange,searchQuery='',refreshTick=0}=_ref;const[rooms,setRooms]=useState([]);const[events,setEvents]=useState([]);const[loading,setLoading]=useState(true);const[start,setStart]=useState(()=>{const d=new Date();d.setHours(0,0,0,0);return d.toISOString().slice(0,10);});const[drag,setDrag]=useState(null);// { res, startDate }\nconst[showHelp,setShowHelp]=useState(true);const loadRooms=async()=>{setLoading(true);try{const{data,error}=await supabase.from('rooms_overview').select('*').order('room_code');if(error)throw error;setRooms(data||[]);}catch(e){console.error('Calendar load failed',e);setRooms([]);}finally{setLoading(false);}};const loadEvents=async(startDate,endDate)=>{try{const{data,error}=await supabase.rpc('get_calendar_reservations',{p_start:startDate,p_end:endDate});if(error)throw error;setEvents(data||[]);}catch(e){console.error('Load calendar reservations failed',e);setEvents([]);}};useEffect(()=>{loadRooms();},[]);useEffect(()=>{const end=new Date(start);end.setDate(end.getDate()+6);loadEvents(start,end.toISOString().slice(0,10));},[start]);// Sync with external selectedDate\nuseEffect(()=>{if(selectedDate&&selectedDate!==start){setStart(selectedDate);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[selectedDate]);// External refresh\nuseEffect(()=>{const end=new Date(start);end.setDate(end.getDate()+6);loadRooms();loadEvents(start,end.toISOString().slice(0,10));// eslint-disable-next-line react-hooks/exhaustive-deps\n},[refreshTick]);const days=daysOfWeek(start);return/*#__PURE__*/_jsxs(\"div\",{className:\"p-8\",dir:\"rtl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold\",children:\"\\u062A\\u0642\\u0648\\u064A\\u0645 \\u0627\\u0644\\u062D\\u062C\\u0648\\u0632\\u0627\\u062A (\\u0623\\u0633\\u0628\\u0648\\u0639)\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"\\u0635\\u064F\\u0645\\u0651\\u0645 \\u0644\\u064A\\u0633\\u0647\\u0651\\u0644 \\u0639\\u0644\\u0649 \\u0627\\u0644\\u0645\\u0628\\u062A\\u062F\\u0626 \\u0641\\u0647\\u0645 \\u0627\\u0644\\u062D\\u0627\\u0644\\u0629 \\u0648\\u0627\\u0644\\u062D\\u0631\\u0643\\u0629\"}),showHelp&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-xs bg-amber-50 border border-amber-200 text-amber-800 rounded px-3 py-2 max-w-2xl\",children:[\"\\u2022 \\u0627\\u062E\\u062A\\u0631 \\u062A\\u0627\\u0631\\u064A\\u062E \\u0628\\u062F\\u0627\\u064A\\u0629 \\u0627\\u0644\\u0623\\u0633\\u0628\\u0648\\u0639 \\u0645\\u0646 \\u0627\\u0644\\u0645\\u0631\\u0628\\u0639 \\u0627\\u0644\\u0645\\u062C\\u0627\\u0648\\u0631 \\u0644\\u0639\\u0631\\u0636 \\u0623\\u0633\\u0628\\u0648\\u0639 \\u0643\\u0627\\u0645\\u0644.\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 \\u0645\\u0631\\u0628\\u0639\\u0627\\u062A \\u0645\\u0644\\u0648\\u0651\\u0646\\u0629 \\u062A\\u0639\\u0646\\u064A \\u0623\\u064A\\u0627\\u0645\\u064B\\u0627 \\u0645\\u062D\\u062C\\u0648\\u0632\\u0629. \\u0627\\u0644\\u0644\\u0648\\u0646 \\u064A\\u0648\\u0636\\u0651\\u062D \\u0627\\u0644\\u062D\\u0627\\u0644\\u0629 (\\u0627\\u0646\\u0638\\u0631 \\u0627\\u0644\\u062F\\u0644\\u064A\\u0644 \\u0623\\u062F\\u0646\\u0627\\u0647).\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 \\u0644\\u0644\\u062A\\u0645\\u062F\\u064A\\u062F: \\u0627\\u0633\\u062D\\u0628 \\u0645\\u0646 \\u0645\\u0631\\u0628\\u0639 \\u0627\\u0644\\u062D\\u062C\\u0632 \\u0625\\u0644\\u0649 \\u064A\\u0648\\u0645 \\u0623\\u0628\\u0639\\u062F \\u0641\\u064A \\u0646\\u0641\\u0633 \\u0635\\u0641 \\u0627\\u0644\\u063A\\u0631\\u0641\\u0629.\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u2022 \\u0644\\u0644\\u0646\\u0642\\u0644: \\u0627\\u0633\\u062D\\u0628 \\u0645\\u0646 \\u0645\\u0631\\u0628\\u0639 \\u0627\\u0644\\u062D\\u062C\\u0632 \\u0625\\u0644\\u0649 \\u0635\\u0641 \\u063A\\u0631\\u0641\\u0629 \\u0623\\u062E\\u0631\\u0649\\u060C \\u0648\\u0633\\u064A\\u064F\\u0646\\u0642\\u0644 \\u0627\\u0644\\u062D\\u062C\\u0632 \\u0644\\u0646\\u0641\\u0633 \\u0639\\u062F\\u062F \\u0627\\u0644\\u0644\\u064A\\u0627\\u0644\\u064A.\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"border rounded px-3 py-2\",type:\"date\",value:start,onChange:e=>{setStart(e.target.value);onDateChange&&onDateChange(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"px-3 py-2 border rounded text-sm\",onClick:()=>setShowHelp(s=>!s),children:showHelp?'إخفاء التعليمات':'إظهار التعليمات'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 bg-white border rounded p-3 text-xs max-w-2xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold mb-2\",children:\"\\u062F\\u0644\\u064A\\u0644 \\u0627\\u0644\\u0623\\u0644\\u0648\\u0627\\u0646\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-3\",children:[{k:'pending',name:'قيد الانتظار'},{k:'confirmed',name:'مؤكد'},{k:'checked_in',name:'تم الدخول'},{k:'checked_out',name:'تم الخروج'},{k:'canceled',name:'ملغي'},{k:'empty',name:'فارغ'}].map((it,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"inline-block w-4 h-4 rounded\",style:{backgroundColor:it.k==='empty'?ReservationStatus.empty.color:getReservationStatusColor(it.k)}}),/*#__PURE__*/_jsx(\"span\",{children:it.name})]},i))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-auto bg-white rounded shadow\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"border-b px-3 py-2 text-right w-40\",children:\"\\u0627\\u0644\\u063A\\u0631\\u0641\\u0629\"}),days.map((d,i)=>/*#__PURE__*/_jsx(\"th\",{className:\"border-b px-3 py-2 text-center w-32\",children:d.toLocaleDateString('ar-EG',{weekday:'long',day:'numeric',month:'numeric'})},i))]})}),/*#__PURE__*/_jsx(\"tbody\",{children:loading?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:8,className:\"px-3 py-4 text-center\",children:\"\\u062A\\u062D\\u0645\\u064A\\u0644...\"})}):rooms.filter(r=>{const term=(searchQuery||'').trim();if(!term)return true;const roomMatch=(r.room_code||r.room_label||'').toLowerCase().includes(term.toLowerCase());const evInRoom=events.some(e=>e.room_id===r.id&&(e.guest_names||e.guest_name||'').toLowerCase().includes(term.toLowerCase()));return roomMatch||evInRoom;}).map(r=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{className:\"border-t px-3 py-2\",children:[r.room_code,\" \\u2013 \",r.room_type_name_ar]}),days.map((d,i)=>{const dayStr=d.toISOString().slice(0,10);let ev=events.find(e=>e.room_id===r.id&&dayStr>=e.start_date&&dayStr<e.end_date);const term=(searchQuery||'').trim().toLowerCase();if(ev&&term){const namesLower=(ev.guest_names||ev.guest_name||'').toLowerCase();if(!namesLower.includes(term)){ev=null;}}const bg=ev?getReservationStatusColor(ev.status):ReservationStatus.empty.color;const title=ev?\"\".concat(ev.room_label,\" | \").concat(ev.guest_names||ev.guest_name,\"\\n\").concat(ev.start_date,\" \\u2192 \").concat(ev.end_date,\" \\u2022 \").concat(getReservationStatusLabelAr(ev.status)):'فارغ';const names=ev?ev.guest_names||ev.guest_name||'':'';const parts=names?names.split('،').map(s=>s.trim()).filter(Boolean):[];const primaryName=parts.length>0?parts[0]:'';const extraCount=parts.length>1?parts.length-1:0;return/*#__PURE__*/_jsx(\"td\",{className:\"border-t px-3 py-2 select-none\",onMouseDown:()=>{if(ev)setDrag({res:ev,startDate:dayStr});},onMouseUp:async()=>{if(drag&&drag.res&&drag.res.room_id===r.id){try{if(drag.startDate!==dayStr){const newEnd=dayStr;const{error}=await supabase.rpc('extend_reservation',{p_reservation_id:drag.res.id,p_new_check_out:newEnd});if(error)throw error;const end=new Date(start);end.setDate(end.getDate()+6);await loadEvents(start,end.toISOString().slice(0,10));}}catch(e){console.error('Drag/resize failed',e);alert('تعذّر تعديل التاريخ بالسحب: '+(e.message||e));}finally{setDrag(null);}}else if(drag&&drag.res){try{const nights=(new Date(drag.res.end_date)-new Date(drag.res.start_date))/(1000*60*60*24);const newStart=dayStr;const endDate=new Date(newStart);endDate.setDate(endDate.getDate()+nights);const newEnd=endDate.toISOString().slice(0,10);const{error}=await supabase.rpc('move_reservation',{p_reservation_id:drag.res.id,p_new_room_id:r.id,p_new_check_in:newStart,p_new_check_out:newEnd});if(error)throw error;const end=new Date(start);end.setDate(end.getDate()+6);await loadEvents(start,end.toISOString().slice(0,10));}catch(e){console.error('Move failed',e);alert('تعذّر نقل الحجز: '+(e.message||e));}finally{setDrag(null);}}},onMouseLeave:()=>{/* ignore */},children:/*#__PURE__*/_jsx(\"div\",{className:\"h-8 rounded flex items-center justify-center\",style:{backgroundColor:bg,cursor:ev?'grab':'default'},title:title,children:ev&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/95 text-gray-800 text-[10px] px-2 py-[2px] rounded-sm shadow-sm border border-white/80 max-w-full flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"truncate\",\"aria-label\":\"\\u0627\\u0644\\u0633\\u0627\\u0643\\u0646 \\u0627\\u0644\\u0631\\u0626\\u064A\\u0633\\u064A\",children:primaryName}),extraCount>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",\"aria-label\":\"\\u0639\\u062F\\u062F \\u0627\\u0644\\u0636\\u064A\\u0648\\u0641 \\u0627\\u0644\\u0625\\u0636\\u0627\\u0641\\u064A\\u064A\\u0646\",children:[\"+\",extraCount]})]})})},i);})]},r.id))})]})}),!loading&&rooms.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 text-sm bg-blue-50 border border-blue-200 text-blue-800 rounded px-3 py-2\",children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u063A\\u0631\\u0641 \\u0645\\u0639\\u0631\\u0648\\u0636\\u0629. \\u0623\\u0636\\u0641 \\u063A\\u0631\\u0641\\u064B\\u0627 \\u0623\\u0648\\u0644\\u064B\\u0627 \\u0645\\u0646 \\u0635\\u0641\\u062D\\u0629 \\u0627\\u0644\\u063A\\u0631\\u0641 \\u0644\\u0639\\u0631\\u0636 \\u0627\\u0644\\u062A\\u0642\\u0648\\u064A\\u0645.\"})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useState","supabase","getReservationStatusColor","getReservationStatusLabelAr","ReservationStatus","jsx","_jsx","jsxs","_jsxs","daysOfWeek","startDate","days","d","Date","i","di","setDate","getDate","push","statusColor","s","v","String","toLowerCase","statusLabelAr","Calendar","_ref","selectedDate","onDateChange","searchQuery","refreshTick","rooms","setRooms","events","setEvents","loading","setLoading","start","setStart","setHours","toISOString","slice","drag","setDrag","showHelp","setShowHelp","loadRooms","data","error","from","select","order","e","console","loadEvents","endDate","rpc","p_start","p_end","end","className","dir","children","type","value","onChange","target","onClick","k","name","map","it","style","backgroundColor","empty","color","toLocaleDateString","weekday","day","month","colSpan","filter","r","term","trim","roomMatch","room_code","room_label","includes","evInRoom","some","room_id","id","guest_names","guest_name","room_type_name_ar","dayStr","ev","find","start_date","end_date","namesLower","bg","status","title","concat","names","parts","split","Boolean","primaryName","length","extraCount","onMouseDown","res","onMouseUp","newEnd","p_reservation_id","p_new_check_out","alert","message","nights","newStart","p_new_room_id","p_new_check_in","onMouseLeave","cursor"],"sources":["F:/kelany/src/pages/Calendar.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { supabase } from '../supabaseClient';\r\nimport { getReservationStatusColor, getReservationStatusLabelAr, ReservationStatus } from '../utils/status';\r\n\r\nconst daysOfWeek = (startDate) => {\r\n  const days = [];\r\n  const d = new Date(startDate);\r\n  for (let i = 0; i < 7; i++) {\r\n    const di = new Date(d);\r\n    di.setDate(d.getDate() + i);\r\n    days.push(di);\r\n  }\r\n  return days;\r\n};\r\n\r\nconst statusColor = (s) => {\r\n  const v = String(s||'').toLowerCase();\r\n  if (v==='pending') return '#f59e0b';\r\n  if (v==='confirmed') return '#10b981';\r\n  if (v==='checked_in') return '#3b82f6';\r\n  if (v==='checked_out') return '#6b7280';\r\n  if (v==='canceled' || v==='cancelled') return '#ef4444';\r\n  if (v==='no_show') return '#f59e0b';\r\n  return '#9ca3af';\r\n};\r\n\r\nconst statusLabelAr = (s) => {\r\n  const v = String(s||'').toLowerCase();\r\n  if (v==='pending') return 'قيد الانتظار';\r\n  if (v==='confirmed') return 'مؤكد';\r\n  if (v==='checked_in') return 'تم الدخول';\r\n  if (v==='checked_out') return 'تم الخروج';\r\n  if (v==='canceled' || v==='cancelled') return 'ملغي';\r\n  if (v==='no_show') return 'لم يحضر';\r\n  return 'غير معروف';\r\n};\r\n\r\nexport default function Calendar({ selectedDate, onDateChange, searchQuery = '', refreshTick = 0 }) {\r\n  const [rooms, setRooms] = useState([]);\r\n  const [events, setEvents] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [start, setStart] = useState(() => {\r\n    const d = new Date();\r\n    d.setHours(0,0,0,0);\r\n    return d.toISOString().slice(0,10);\r\n  });\r\n  const [drag, setDrag] = useState(null); // { res, startDate }\r\n  const [showHelp, setShowHelp] = useState(true);\r\n\r\n  const loadRooms = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data, error } = await supabase.from('rooms_overview').select('*').order('room_code');\r\n      if (error) throw error;\r\n      setRooms(data || []);\r\n    } catch (e) {\r\n      console.error('Calendar load failed', e);\r\n      setRooms([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadEvents = async (startDate, endDate) => {\r\n    try {\r\n      const { data, error } = await supabase.rpc('get_calendar_reservations', { p_start: startDate, p_end: endDate });\r\n      if (error) throw error;\r\n      setEvents(data || []);\r\n    } catch (e) {\r\n      console.error('Load calendar reservations failed', e);\r\n      setEvents([]);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { loadRooms(); }, []);\r\n  useEffect(() => {\r\n    const end = new Date(start);\r\n    end.setDate(end.getDate() + 6);\r\n    loadEvents(start, end.toISOString().slice(0,10));\r\n  }, [start]);\r\n\r\n  // Sync with external selectedDate\r\n  useEffect(() => {\r\n    if (selectedDate && selectedDate !== start) {\r\n      setStart(selectedDate);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [selectedDate]);\r\n\r\n  // External refresh\r\n  useEffect(() => {\r\n    const end = new Date(start);\r\n    end.setDate(end.getDate() + 6);\r\n    loadRooms();\r\n    loadEvents(start, end.toISOString().slice(0,10));\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [refreshTick]);\r\n\r\n  const days = daysOfWeek(start);\r\n\r\n  return (\r\n    <div className=\"p-8\" dir=\"rtl\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold\">تقويم الحجوزات (أسبوع)</h2>\r\n          <p className=\"text-sm text-gray-500\">صُمّم ليسهّل على المبتدئ فهم الحالة والحركة</p>\r\n          {showHelp && (\r\n            <div className=\"mt-2 text-xs bg-amber-50 border border-amber-200 text-amber-800 rounded px-3 py-2 max-w-2xl\">\r\n              • اختر تاريخ بداية الأسبوع من المربع المجاور لعرض أسبوع كامل.<br />\r\n              • مربعات ملوّنة تعني أيامًا محجوزة. اللون يوضّح الحالة (انظر الدليل أدناه).<br />\r\n              • للتمديد: اسحب من مربع الحجز إلى يوم أبعد في نفس صف الغرفة.<br />\r\n              • للنقل: اسحب من مربع الحجز إلى صف غرفة أخرى، وسيُنقل الحجز لنفس عدد الليالي.\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <input className=\"border rounded px-3 py-2\" type=\"date\" value={start} onChange={e=>{ setStart(e.target.value); onDateChange && onDateChange(e.target.value); }} />\r\n          <button className=\"px-3 py-2 border rounded text-sm\" onClick={()=>setShowHelp(s=>!s)}>{showHelp?'إخفاء التعليمات':'إظهار التعليمات'}</button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* دليل الألوان */}\r\n      <div className=\"mb-4 bg-white border rounded p-3 text-xs max-w-2xl\">\r\n        <div className=\"font-semibold mb-2\">دليل الألوان</div>\r\n        <div className=\"flex flex-wrap gap-3\">\r\n          {[\r\n            {k:'pending', name:'قيد الانتظار'},\r\n            {k:'confirmed', name:'مؤكد'},\r\n            {k:'checked_in', name:'تم الدخول'},\r\n            {k:'checked_out', name:'تم الخروج'},\r\n            {k:'canceled', name:'ملغي'},\r\n            {k:'empty', name:'فارغ'}\r\n          ].map((it,i)=> (\r\n            <div key={i} className=\"flex items-center gap-2\">\r\n              <span className=\"inline-block w-4 h-4 rounded\" style={{ backgroundColor: it.k==='empty' ? ReservationStatus.empty.color : getReservationStatusColor(it.k) }} />\r\n              <span>{it.name}</span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"overflow-auto bg-white rounded shadow\">\r\n        <table className=\"min-w-full text-sm\">\r\n          <thead>\r\n            <tr>\r\n              <th className=\"border-b px-3 py-2 text-right w-40\">الغرفة</th>\r\n              {days.map((d,i)=> (\r\n                <th key={i} className=\"border-b px-3 py-2 text-center w-32\">{d.toLocaleDateString('ar-EG', { weekday: 'long', day: 'numeric', month: 'numeric' })}</th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {loading ? (\r\n              <tr><td colSpan={8} className=\"px-3 py-4 text-center\">تحميل...</td></tr>\r\n            ) : rooms\r\n              .filter(r => {\r\n                const term = (searchQuery || '').trim();\r\n                if (!term) return true;\r\n                const roomMatch = (r.room_code || r.room_label || '').toLowerCase().includes(term.toLowerCase());\r\n                const evInRoom = events.some(e => e.room_id === r.id && ((e.guest_names || e.guest_name || '').toLowerCase().includes(term.toLowerCase())));\r\n                return roomMatch || evInRoom;\r\n              })\r\n              .map(r => (\r\n              <tr key={r.id}>\r\n                <td className=\"border-t px-3 py-2\">{r.room_code} – {r.room_type_name_ar}</td>\r\n                {days.map((d,i)=> {\r\n                  const dayStr = d.toISOString().slice(0,10);\r\n                  let ev = events.find(e => e.room_id === r.id && dayStr >= e.start_date && dayStr < e.end_date);\r\n                  const term = (searchQuery || '').trim().toLowerCase();\r\n                  if (ev && term) {\r\n                    const namesLower = (ev.guest_names || ev.guest_name || '').toLowerCase();\r\n                    if (!(namesLower.includes(term))) {\r\n                      ev = null;\r\n                    }\r\n                  }\r\n                  const bg = ev ? getReservationStatusColor(ev.status) : ReservationStatus.empty.color;\r\n                  const title = ev ? `${ev.room_label} | ${ev.guest_names || ev.guest_name}\\n${ev.start_date} → ${ev.end_date} • ${getReservationStatusLabelAr(ev.status)}` : 'فارغ';\r\n                  const names = ev ? ((ev.guest_names || ev.guest_name || '')) : '';\r\n                  const parts = names ? names.split('،').map(s => s.trim()).filter(Boolean) : [];\r\n                  const primaryName = parts.length > 0 ? parts[0] : '';\r\n                  const extraCount = parts.length > 1 ? (parts.length - 1) : 0;\r\n                  return (\r\n                    <td key={i} className=\"border-t px-3 py-2 select-none\"\r\n                        onMouseDown={() => { if (ev) setDrag({ res: ev, startDate: dayStr }); }}\r\n                        onMouseUp={async () => {\r\n                          if (drag && drag.res && drag.res.room_id === r.id) {\r\n                            try {\r\n                              if (drag.startDate !== dayStr) {\r\n                                const newEnd = dayStr;\r\n                                const { error } = await supabase.rpc('extend_reservation', { p_reservation_id: drag.res.id, p_new_check_out: newEnd });\r\n                                if (error) throw error;\r\n                                const end = new Date(start); end.setDate(end.getDate() + 6);\r\n                                await loadEvents(start, end.toISOString().slice(0,10));\r\n                              }\r\n                            } catch(e) {\r\n                              console.error('Drag/resize failed', e);\r\n                              alert('تعذّر تعديل التاريخ بالسحب: '+(e.message||e));\r\n                            } finally {\r\n                              setDrag(null);\r\n                            }\r\n                          }\r\n                          else if (drag && drag.res) {\r\n                            try {\r\n                              const nights = (new Date(drag.res.end_date) - new Date(drag.res.start_date)) / (1000*60*60*24);\r\n                              const newStart = dayStr;\r\n                              const endDate = new Date(newStart);\r\n                              endDate.setDate(endDate.getDate() + nights);\r\n                              const newEnd = endDate.toISOString().slice(0,10);\r\n                              const { error } = await supabase.rpc('move_reservation', {\r\n                                p_reservation_id: drag.res.id,\r\n                                p_new_room_id: r.id,\r\n                                p_new_check_in: newStart,\r\n                                p_new_check_out: newEnd,\r\n                              });\r\n                              if (error) throw error;\r\n                              const end = new Date(start); end.setDate(end.getDate() + 6);\r\n                              await loadEvents(start, end.toISOString().slice(0,10));\r\n                            } catch(e) {\r\n                              console.error('Move failed', e);\r\n                              alert('تعذّر نقل الحجز: '+(e.message||e));\r\n                            } finally { setDrag(null); }\r\n                          }\r\n                        }}\r\n                        onMouseLeave={() => { /* ignore */ }}\r\n                    >\r\n                      <div className=\"h-8 rounded flex items-center justify-center\" style={{ backgroundColor: bg, cursor: ev ? 'grab' : 'default' }} title={title}>\r\n                        {ev && (\r\n                          <div className=\"bg-white/95 text-gray-800 text-[10px] px-2 py-[2px] rounded-sm shadow-sm border border-white/80 max-w-full flex items-center gap-1\">\r\n                            <span className=\"truncate\" aria-label=\"الساكن الرئيسي\">{primaryName}</span>\r\n                            {extraCount > 0 && (\r\n                              <span className=\"text-gray-500\" aria-label=\"عدد الضيوف الإضافيين\">+{extraCount}</span>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </td>\r\n                  );\r\n                })}\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n        {!loading && rooms.length===0 && (\r\n          <div className=\"mt-4 text-sm bg-blue-50 border border-blue-200 text-blue-800 rounded px-3 py-2\">\r\n            لا توجد غرف معروضة. أضف غرفًا أولًا من صفحة الغرف لعرض التقويم.\r\n          </div>\r\n        )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}