{"ast":null,"code":"var _jsxFileName = \"F:\\\\kelany\\\\src\\\\pages\\\\Floors.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { supabase } from '../supabaseClient';\nimport RoomCard from '../components/RoomCard';\nimport FloorModal from '../components/FloorModal';\nimport { MaintenanceIcon, CardIcon, ScheduleIcon, OccupancyIcon } from '../components/Icons';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Floors() {\n  _s();\n  const [buildings, setBuildings] = useState([]);\n  const [selectedBuilding, setSelectedBuilding] = useState(null);\n  const [floors, setFloors] = useState([]);\n  const [rooms, setRooms] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showFloorModal, setShowFloorModal] = useState(false);\n  const [editingFloor, setEditingFloor] = useState(null);\n  const loadBuildings = async () => {\n    const {\n      data,\n      error\n    } = await supabase.from('buildings').select('*').order('created_at', {\n      ascending: false\n    });\n    if (!error) {\n      setBuildings(data || []);\n      if (!selectedBuilding && data && data.length) setSelectedBuilding(data[0]);\n    }\n  };\n  const loadData = async buildingId => {\n    setLoading(true);\n    try {\n      const {\n        data: fdata,\n        error: ferr\n      } = await supabase.from('building_floor_overview').select('*').eq('building_id', buildingId).order('floor_number', {\n        ascending: true\n      });\n      if (!ferr) setFloors(fdata || []);\n      const {\n        data: rdata,\n        error: rerr\n      } = await supabase.from('rooms_by_floor').select('*').eq('building_id', buildingId).order('room_code', {\n        ascending: true\n      });\n      if (!rerr) setRooms(rdata || []);\n    } catch (e) {\n      console.error(e);\n      setFloors([]);\n      setRooms([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    loadBuildings();\n  }, []);\n  useEffect(() => {\n    if (selectedBuilding) loadData(selectedBuilding.id);\n  }, [selectedBuilding]);\n  const goToAddRooms = (buildingId, floorNumber) => {\n    const url = `/rooms?building=${buildingId}&floor=${floorNumber}`;\n    try {\n      window.location.href = url;\n    } catch (e) {\n      console.log('navigate', url);\n    }\n  };\n  const handleEditFloor = floor => {\n    setEditingFloor(floor);\n    setShowFloorModal(true);\n  };\n  const handleSaveFloor = async payload => {\n    try {\n      const id = payload.id;\n      if (!id) throw new Error('Missing floor id');\n\n      // 1) update status + description (if present). If DB lacks `description`, retry without it.\n      const baseUpdate = {\n        status: payload.status\n      };\n      if (payload.description !== null && payload.description !== undefined) baseUpdate.description = payload.description;\n      let data, error;\n      ({\n        data,\n        error\n      } = await supabase.from('floors').update(baseUpdate).eq('id', id));\n      if (error) {\n        const msg = (error.message || '').toLowerCase();\n        if (baseUpdate.description && (msg.includes('column \"description\"') || msg.includes(\"could not find the 'description'\") || msg.includes('does not exist'))) {\n          // retry without description\n          delete baseUpdate.description;\n          ({\n            data,\n            error\n          } = await supabase.from('floors').update(baseUpdate).eq('id', id));\n        }\n      }\n      if (error) throw error;\n\n      // 2) attempt to update the floor name if provided — try common column names\n      if (payload.name) {\n        const nameCandidates = ['floor_name', 'name'];\n        let nameUpdated = false;\n        for (const col of nameCandidates) {\n          const np = {};\n          np[col] = payload.name;\n          const res = await supabase.from('floors').update(np).eq('id', id);\n          if (!res.error) {\n            nameUpdated = true;\n            break;\n          }\n          const em = (res.error.message || '').toLowerCase();\n          if (em.includes(`column \"${col}\"`) || em.includes(`could not find the '${col}'`) || em.includes('does not exist')) {\n            // try next candidate\n            continue;\n          }\n          // other errors: throw\n          throw res.error;\n        }\n        if (!nameUpdated) {\n          console.warn('Name column not found (tried floor_name/name), skipping name update');\n        }\n      }\n      setShowFloorModal(false);\n      loadData(selectedBuilding.id);\n    } catch (e) {\n      console.error('Failed saving floor', e);\n      window.alert('حصل خطأ أثناء حفظ الطابق: ' + (e.message || e));\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between mb-6\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold\",\n          children: \"\\u0625\\u062F\\u0627\\u0631\\u0629 \\u0627\\u0644\\u0637\\u0648\\u0627\\u0628\\u0642\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500\",\n          children: \"\\u0639\\u0631\\u0636 \\u0648\\u0637\\u0628\\u0627\\u0639\\u0629 \\u0637\\u0648\\u0627\\u0628\\u0642 \\u0648\\u063A\\u0631\\u0641 \\u0627\\u0644\\u0645\\u0628\\u0646\\u0649\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex gap-4 overflow-auto\",\n        children: buildings.map(b => /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setSelectedBuilding(b),\n          className: `min-w-[160px] p-4 rounded shadow flex flex-col items-start justify-center ${selectedBuilding && selectedBuilding.id === b.id ? 'border-2 border-blue-400 bg-white' : 'bg-white/80'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-500\",\n            children: [\"\\u0645\\u0628\\u0646\\u0649 \", b.code]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-semibold\",\n            children: b.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs mt-2 inline-flex items-center gap-2\",\n            children: b.status === 'maintenance' ? /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"px-2 py-1 rounded text-yellow-800 bg-yellow-100\",\n              children: \"\\u0635\\u064A\\u0627\\u0646\\u0629\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 19\n            }, this) : b.status === 'inactive' ? /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"px-2 py-1 rounded text-gray-700 bg-gray-100\",\n              children: \"\\u063A\\u064A\\u0631 \\u0646\\u0634\\u0637\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"px-2 py-1 rounded text-white bg-green-500\",\n              children: \"\\u0646\\u0634\\u0637\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 15\n          }, this)]\n        }, b.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-6 grid grid-cols-2 md:grid-cols-5 gap-4\",\n        children: (() => {\n          // aggregate counts from floors\n          const totals = floors.reduce((acc, f) => {\n            acc.total += Number(f.total_rooms || 0);\n            acc.available += Number(f.available_rooms || 0);\n            acc.occupied += Number(f.occupied_rooms || 0);\n            acc.reserved += Number(f.reserved_rooms || 0);\n            acc.maintenance += Number(f.maintenance_rooms || 0);\n            return acc;\n          }, {\n            total: 0,\n            available: 0,\n            occupied: 0,\n            reserved: 0,\n            maintenance: 0\n          });\n          return [{\n            key: 'total',\n            label: 'إجمالي الغرف',\n            value: totals.total,\n            color: 'bg-white'\n          }, {\n            key: 'available',\n            label: 'متاحة',\n            value: totals.available,\n            color: 'bg-green-50'\n          }, {\n            key: 'reserved',\n            label: 'محجوزة',\n            value: totals.reserved,\n            color: 'bg-yellow-50'\n          }, {\n            key: 'occupied',\n            label: 'مشغولة',\n            value: totals.occupied,\n            color: 'bg-red-50'\n          }, {\n            key: 'maintenance',\n            label: 'صيانة',\n            value: totals.maintenance,\n            color: 'bg-gray-50'\n          }].map(box => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `p-4 rounded shadow ${box.color}`,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-500\",\n              children: box.label\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xl font-semibold\",\n              children: box.value\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 17\n            }, this)]\n          }, box.key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 15\n          }, this));\n        })()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"\\u062A\\u062D\\u0645\\u064A\\u0644...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-6\",\n      children: [floors.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6 bg-white rounded shadow\",\n        children: \"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0637\\u0648\\u0627\\u0628\\u0642 \\u0644\\u0639\\u0631\\u0636\\u0647\\u0627 \\u0641\\u064A \\u0647\\u0630\\u0627 \\u0627\\u0644\\u0645\\u0628\\u0646\\u0649.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 13\n      }, this) : floors.map(f => /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"bg-white rounded shadow\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-4 flex items-center justify-between\",\n          style: f.status === 'maintenance' ? {\n            background: 'linear-gradient(90deg,#ff416c,#ff4b2b)'\n          } : f.status === 'inactive' ? {\n            background: 'linear-gradient(90deg,#757f9a,#d7dde8)'\n          } : {\n            background: 'linear-gradient(90deg,#6a11cb,#2575fc)'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-white\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-lg font-semibold\",\n              children: [\"\\u0627\\u0644\\u0637\\u0627\\u0628\\u0642 \", f.floor_number]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm opacity-90\",\n              children: [f.total_rooms, \" \\u0625\\u062C\\u0645\\u0627\\u0644\\u064A \\xB7 \", f.available_rooms, \" \\u0645\\u062A\\u0627\\u062D\\u0629 \\xB7 \", f.occupied_rooms, \" \\u0645\\u0634\\u063A\\u0648\\u0644\\u0629\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-white text-sm flex items-center gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleEditFloor(f),\n              className: \"bg-white/20 px-3 py-1 rounded text-white\",\n              children: \"\\u062A\\u0639\\u062F\\u064A\\u0644 \\u0627\\u0644\\u0637\\u0627\\u0628\\u0642\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: selectedBuilding && selectedBuilding.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-6\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex gap-4 overflow-x-auto\",\n            children: rooms.filter(r => r.floor_id === f.floor_id).length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-full py-8 text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-gray-400 mb-4\",\n                children: \"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u063A\\u0631\\u0641 \\u0641\\u064A \\u0647\\u0630\\u0627 \\u0627\\u0644\\u0637\\u0627\\u0628\\u0642\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => goToAddRooms(f.building_id, f.floor_number),\n                className: \"bg-blue-600 text-white px-4 py-2 rounded\",\n                children: \"\\u0625\\u0636\\u0627\\u0641\\u0629 \\u063A\\u0631\\u0641\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 214,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 23\n            }, this) : rooms.filter(r => r.floor_id === f.floor_id).map(r => /*#__PURE__*/_jsxDEV(RoomCard, {\n              room: r\n            }, r.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 25\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 17\n        }, this)]\n      }, f.floor_id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 15\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded shadow p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-semibold mb-3\",\n          children: \"\\u0645\\u062E\\u0637\\u0637 \\u0627\\u0644\\u0645\\u0628\\u0646\\u0649 \\u0627\\u0644\\u0643\\u0627\\u0645\\u0644\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overflow-auto\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"w-full text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"text-left text-gray-500\",\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2\",\n                  children: \"\\u0627\\u0644\\u0637\\u0627\\u0628\\u0642\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2\",\n                  children: \"\\u0639\\u062F\\u062F \\u0627\\u0644\\u063A\\u0631\\u0641\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 234,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2\",\n                  children: \"\\u0645\\u062A\\u0627\\u062D\\u0629\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 235,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2\",\n                  children: \"\\u0645\\u0634\\u063A\\u0648\\u0644\\u0629\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2\",\n                  children: \"\\u0645\\u062D\\u062C\\u0648\\u0632\\u0629\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2\",\n                  children: \"\\u0635\\u064A\\u0627\\u0646\\u0629\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 238,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"p-2\",\n                  children: \"\\u0645\\u0639\\u062F\\u0644 \\u0627\\u0644\\u0627\\u0634\\u063A\\u0627\\u0644\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: floors.map(f => /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"border-t\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2\",\n                  children: [\"\\u0627\\u0644\\u0637\\u0627\\u0628\\u0642 \", f.floor_number]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2\",\n                  children: f.total_rooms\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 text-green-600\",\n                  children: f.available_rooms\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 text-red-600\",\n                  children: f.occupied_rooms\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2 text-yellow-600\",\n                  children: f.reserved_rooms\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2\",\n                  children: f.maintenance_rooms\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"p-2\",\n                  children: [Math.round((f.occupancy_rate || 0) * 100), \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 251,\n                  columnNumber: 23\n                }, this)]\n              }, f.floor_id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 9\n    }, this), showFloorModal && /*#__PURE__*/_jsxDEV(FloorModal, {\n      initialData: editingFloor,\n      onClose: () => setShowFloorModal(false),\n      onSave: handleSaveFloor\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 124,\n    columnNumber: 5\n  }, this);\n}\n_s(Floors, \"p0XfE2oSdTL0C62Puxv+WZiNYaY=\");\n_c = Floors;\nvar _c;\n$RefreshReg$(_c, \"Floors\");","map":{"version":3,"names":["React","useEffect","useState","supabase","RoomCard","FloorModal","MaintenanceIcon","CardIcon","ScheduleIcon","OccupancyIcon","jsxDEV","_jsxDEV","Floors","_s","buildings","setBuildings","selectedBuilding","setSelectedBuilding","floors","setFloors","rooms","setRooms","loading","setLoading","showFloorModal","setShowFloorModal","editingFloor","setEditingFloor","loadBuildings","data","error","from","select","order","ascending","length","loadData","buildingId","fdata","ferr","eq","rdata","rerr","e","console","id","goToAddRooms","floorNumber","url","window","location","href","log","handleEditFloor","floor","handleSaveFloor","payload","Error","baseUpdate","status","description","undefined","update","msg","message","toLowerCase","includes","name","nameCandidates","nameUpdated","col","np","res","em","warn","alert","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","b","onClick","code","totals","reduce","acc","f","total","Number","total_rooms","available","available_rooms","occupied","occupied_rooms","reserved","reserved_rooms","maintenance","maintenance_rooms","key","label","value","color","box","style","background","floor_number","filter","r","floor_id","building_id","room","Math","round","occupancy_rate","initialData","onClose","onSave","_c","$RefreshReg$"],"sources":["F:/kelany/src/pages/Floors.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { supabase } from '../supabaseClient';\r\nimport RoomCard from '../components/RoomCard';\r\nimport FloorModal from '../components/FloorModal';\r\nimport { MaintenanceIcon, CardIcon, ScheduleIcon, OccupancyIcon } from '../components/Icons';\r\n\r\nexport default function Floors() {\r\n  const [buildings, setBuildings] = useState([]);\r\n  const [selectedBuilding, setSelectedBuilding] = useState(null);\r\n  const [floors, setFloors] = useState([]);\r\n  const [rooms, setRooms] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showFloorModal, setShowFloorModal] = useState(false);\r\n  const [editingFloor, setEditingFloor] = useState(null);\r\n\r\n  const loadBuildings = async () => {\r\n    const { data, error } = await supabase.from('buildings').select('*').order('created_at', { ascending: false });\r\n    if (!error) {\r\n      setBuildings(data || []);\r\n      if (!selectedBuilding && data && data.length) setSelectedBuilding(data[0]);\r\n    }\r\n  };\r\n\r\n  const loadData = async (buildingId) => {\r\n    setLoading(true);\r\n    try {\r\n      const { data: fdata, error: ferr } = await supabase\r\n        .from('building_floor_overview')\r\n        .select('*')\r\n        .eq('building_id', buildingId)\r\n        .order('floor_number', { ascending: true });\r\n      if (!ferr) setFloors(fdata || []);\r\n\r\n      const { data: rdata, error: rerr } = await supabase\r\n        .from('rooms_by_floor')\r\n        .select('*')\r\n        .eq('building_id', buildingId)\r\n        .order('room_code', { ascending: true });\r\n      if (!rerr) setRooms(rdata || []);\r\n    } catch (e) {\r\n      console.error(e);\r\n      setFloors([]);\r\n      setRooms([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadBuildings();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (selectedBuilding) loadData(selectedBuilding.id);\r\n  }, [selectedBuilding]);\r\n\r\n  const goToAddRooms = (buildingId, floorNumber) => {\r\n    const url = `/rooms?building=${buildingId}&floor=${floorNumber}`;\r\n    try { window.location.href = url; } catch (e) { console.log('navigate', url); }\r\n  };\r\n\r\n  const handleEditFloor = (floor) => {\r\n    setEditingFloor(floor);\r\n    setShowFloorModal(true);\r\n  };\r\n\r\n  const handleSaveFloor = async (payload) => {\r\n    try {\r\n      const id = payload.id;\r\n      if (!id) throw new Error('Missing floor id');\r\n\r\n      // 1) update status + description (if present). If DB lacks `description`, retry without it.\r\n      const baseUpdate = { status: payload.status };\r\n      if (payload.description !== null && payload.description !== undefined) baseUpdate.description = payload.description;\r\n\r\n      let data, error;\r\n      ({ data, error } = await supabase.from('floors').update(baseUpdate).eq('id', id));\r\n\r\n      if (error) {\r\n        const msg = (error.message || '').toLowerCase();\r\n        if (baseUpdate.description && (msg.includes('column \"description\"') || msg.includes(\"could not find the 'description'\") || msg.includes('does not exist'))) {\r\n          // retry without description\r\n          delete baseUpdate.description;\r\n          ({ data, error } = await supabase.from('floors').update(baseUpdate).eq('id', id));\r\n        }\r\n      }\r\n\r\n      if (error) throw error;\r\n\r\n      // 2) attempt to update the floor name if provided — try common column names\r\n      if (payload.name) {\r\n        const nameCandidates = ['floor_name', 'name'];\r\n        let nameUpdated = false;\r\n        for (const col of nameCandidates) {\r\n          const np = {};\r\n          np[col] = payload.name;\r\n          const res = await supabase.from('floors').update(np).eq('id', id);\r\n          if (!res.error) {\r\n            nameUpdated = true;\r\n            break;\r\n          }\r\n          const em = (res.error.message || '').toLowerCase();\r\n          if (em.includes(`column \"${col}\"`) || em.includes(`could not find the '${col}'`) || em.includes('does not exist')) {\r\n            // try next candidate\r\n            continue;\r\n          }\r\n          // other errors: throw\r\n          throw res.error;\r\n        }\r\n        if (!nameUpdated) {\r\n          console.warn('Name column not found (tried floor_name/name), skipping name update');\r\n        }\r\n      }\r\n\r\n      setShowFloorModal(false);\r\n      loadData(selectedBuilding.id);\r\n    } catch (e) {\r\n      console.error('Failed saving floor', e);\r\n      window.alert('حصل خطأ أثناء حفظ الطابق: ' + (e.message || e));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-8\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold\">إدارة الطوابق</h2>\r\n          <p className=\"text-sm text-gray-500\">عرض وطباعة طوابق وغرف المبنى</p>\r\n        </div>\r\n      </div>\r\n      <div className=\"mb-6\">\r\n        <div className=\"flex gap-4 overflow-auto\">\r\n          {buildings.map((b) => (\r\n            <button key={b.id}\r\n              onClick={() => setSelectedBuilding(b)}\r\n              className={`min-w-[160px] p-4 rounded shadow flex flex-col items-start justify-center ${selectedBuilding && selectedBuilding.id === b.id ? 'border-2 border-blue-400 bg-white' : 'bg-white/80'}`}>\r\n              <div className=\"text-sm text-gray-500\">مبنى {b.code}</div>\r\n              <div className=\"font-semibold\">{b.name}</div>\r\n              <div className=\"text-xs mt-2 inline-flex items-center gap-2\">\r\n                {b.status === 'maintenance' ? (\r\n                  <span className=\"px-2 py-1 rounded text-yellow-800 bg-yellow-100\">صيانة</span>\r\n                ) : b.status === 'inactive' ? (\r\n                  <span className=\"px-2 py-1 rounded text-gray-700 bg-gray-100\">غير نشط</span>\r\n                ) : (\r\n                  <span className=\"px-2 py-1 rounded text-white bg-green-500\">نشط</span>\r\n                )}\r\n              </div>\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Summary boxes */}\r\n        <div className=\"mt-6 grid grid-cols-2 md:grid-cols-5 gap-4\">\r\n          {(() => {\r\n            // aggregate counts from floors\r\n            const totals = floors.reduce((acc, f) => {\r\n              acc.total += Number(f.total_rooms || 0);\r\n              acc.available += Number(f.available_rooms || 0);\r\n              acc.occupied += Number(f.occupied_rooms || 0);\r\n              acc.reserved += Number(f.reserved_rooms || 0);\r\n              acc.maintenance += Number(f.maintenance_rooms || 0);\r\n              return acc;\r\n            }, { total: 0, available: 0, occupied: 0, reserved: 0, maintenance: 0 });\r\n            return [\r\n              { key: 'total', label: 'إجمالي الغرف', value: totals.total, color: 'bg-white' },\r\n              { key: 'available', label: 'متاحة', value: totals.available, color: 'bg-green-50' },\r\n              { key: 'reserved', label: 'محجوزة', value: totals.reserved, color: 'bg-yellow-50' },\r\n              { key: 'occupied', label: 'مشغولة', value: totals.occupied, color: 'bg-red-50' },\r\n              { key: 'maintenance', label: 'صيانة', value: totals.maintenance, color: 'bg-gray-50' },\r\n            ].map(box => (\r\n              <div key={box.key} className={`p-4 rounded shadow ${box.color}`}>\r\n                <div className=\"text-sm text-gray-500\">{box.label}</div>\r\n                <div className=\"text-xl font-semibold\">{box.value}</div>\r\n              </div>\r\n            ));\r\n          })()}\r\n        </div>\r\n      </div>\r\n\r\n      {loading ? (\r\n        <div>تحميل...</div>\r\n      ) : (\r\n        <div className=\"space-y-6\">\r\n          {floors.length === 0 ? (\r\n            <div className=\"p-6 bg-white rounded shadow\">لا توجد طوابق لعرضها في هذا المبنى.</div>\r\n          ) : (\r\n            floors.map((f) => (\r\n              <section key={f.floor_id} className=\"bg-white rounded shadow\">\r\n                <div\r\n                  className=\"p-4 flex items-center justify-between\"\r\n                  style={\r\n                    f.status === 'maintenance'\r\n                      ? { background: 'linear-gradient(90deg,#ff416c,#ff4b2b)' }\r\n                      : f.status === 'inactive'\r\n                      ? { background: 'linear-gradient(90deg,#757f9a,#d7dde8)' }\r\n                      : { background: 'linear-gradient(90deg,#6a11cb,#2575fc)' }\r\n                  }\r\n                >\r\n                  <div className=\"text-white\">\r\n                    <div className=\"text-lg font-semibold\">الطابق {f.floor_number}</div>\r\n                    <div className=\"text-sm opacity-90\">{f.total_rooms} إجمالي · {f.available_rooms} متاحة · {f.occupied_rooms} مشغولة</div>\r\n                  </div>\r\n                  <div className=\"text-white text-sm flex items-center gap-3\">\r\n                    <button onClick={() => handleEditFloor(f)} className=\"bg-white/20 px-3 py-1 rounded text-white\">تعديل الطابق</button>\r\n                    <div>{selectedBuilding && selectedBuilding.name}</div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"p-6\">\r\n                  <div className=\"flex gap-4 overflow-x-auto\">\r\n                    {rooms.filter(r => r.floor_id === f.floor_id).length === 0 ? (\r\n                      <div className=\"w-full py-8 text-center\">\r\n                        <div className=\"text-gray-400 mb-4\">لا توجد غرف في هذا الطابق</div>\r\n                        <button onClick={() => goToAddRooms(f.building_id, f.floor_number)} className=\"bg-blue-600 text-white px-4 py-2 rounded\">إضافة غرف</button>\r\n                      </div>\r\n                    ) : (\r\n                      rooms.filter(r => r.floor_id === f.floor_id).map((r) => (\r\n                        <RoomCard key={r.id} room={r} />\r\n                      ))\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </section>\r\n            ))\r\n          )}\r\n\r\n          <div className=\"bg-white rounded shadow p-4\">\r\n            <h3 className=\"font-semibold mb-3\">مخطط المبنى الكامل</h3>\r\n            <div className=\"overflow-auto\">\r\n              <table className=\"w-full text-sm\">\r\n                <thead>\r\n                  <tr className=\"text-left text-gray-500\">\r\n                    <th className=\"p-2\">الطابق</th>\r\n                    <th className=\"p-2\">عدد الغرف</th>\r\n                    <th className=\"p-2\">متاحة</th>\r\n                    <th className=\"p-2\">مشغولة</th>\r\n                    <th className=\"p-2\">محجوزة</th>\r\n                    <th className=\"p-2\">صيانة</th>\r\n                    <th className=\"p-2\">معدل الاشغال</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {floors.map((f) => (\r\n                    <tr key={f.floor_id} className=\"border-t\">\r\n                      <td className=\"p-2\">الطابق {f.floor_number}</td>\r\n                      <td className=\"p-2\">{f.total_rooms}</td>\r\n                      <td className=\"p-2 text-green-600\">{f.available_rooms}</td>\r\n                      <td className=\"p-2 text-red-600\">{f.occupied_rooms}</td>\r\n                      <td className=\"p-2 text-yellow-600\">{f.reserved_rooms}</td>\r\n                      <td className=\"p-2\">{f.maintenance_rooms}</td>\r\n                      <td className=\"p-2\">{Math.round((f.occupancy_rate || 0) * 100)}%</td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n      )}\r\n\r\n      {showFloorModal && (\r\n        <FloorModal\r\n          initialData={editingFloor}\r\n          onClose={() => setShowFloorModal(false)}\r\n          onSave={handleSaveFloor}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,QAAQ,QAAQ,mBAAmB;AAC5C,OAAOC,QAAQ,MAAM,wBAAwB;AAC7C,OAAOC,UAAU,MAAM,0BAA0B;AACjD,SAASC,eAAe,EAAEC,QAAQ,EAAEC,YAAY,EAAEC,aAAa,QAAQ,qBAAqB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7F,eAAe,SAASC,MAAMA,CAAA,EAAG;EAAAC,EAAA;EAC/B,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACc,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;EAC9D,MAAM,CAACgB,MAAM,EAAEC,SAAS,CAAC,GAAGjB,QAAQ,CAAC,EAAE,CAAC;EACxC,MAAM,CAACkB,KAAK,EAAEC,QAAQ,CAAC,GAAGnB,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACoB,OAAO,EAAEC,UAAU,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACsB,cAAc,EAAEC,iBAAiB,CAAC,GAAGvB,QAAQ,CAAC,KAAK,CAAC;EAC3D,MAAM,CAACwB,YAAY,EAAEC,eAAe,CAAC,GAAGzB,QAAQ,CAAC,IAAI,CAAC;EAEtD,MAAM0B,aAAa,GAAG,MAAAA,CAAA,KAAY;IAChC,MAAM;MAAEC,IAAI;MAAEC;IAAM,CAAC,GAAG,MAAM3B,QAAQ,CAAC4B,IAAI,CAAC,WAAW,CAAC,CAACC,MAAM,CAAC,GAAG,CAAC,CAACC,KAAK,CAAC,YAAY,EAAE;MAAEC,SAAS,EAAE;IAAM,CAAC,CAAC;IAC9G,IAAI,CAACJ,KAAK,EAAE;MACVf,YAAY,CAACc,IAAI,IAAI,EAAE,CAAC;MACxB,IAAI,CAACb,gBAAgB,IAAIa,IAAI,IAAIA,IAAI,CAACM,MAAM,EAAElB,mBAAmB,CAACY,IAAI,CAAC,CAAC,CAAC,CAAC;IAC5E;EACF,CAAC;EAED,MAAMO,QAAQ,GAAG,MAAOC,UAAU,IAAK;IACrCd,UAAU,CAAC,IAAI,CAAC;IAChB,IAAI;MACF,MAAM;QAAEM,IAAI,EAAES,KAAK;QAAER,KAAK,EAAES;MAAK,CAAC,GAAG,MAAMpC,QAAQ,CAChD4B,IAAI,CAAC,yBAAyB,CAAC,CAC/BC,MAAM,CAAC,GAAG,CAAC,CACXQ,EAAE,CAAC,aAAa,EAAEH,UAAU,CAAC,CAC7BJ,KAAK,CAAC,cAAc,EAAE;QAAEC,SAAS,EAAE;MAAK,CAAC,CAAC;MAC7C,IAAI,CAACK,IAAI,EAAEpB,SAAS,CAACmB,KAAK,IAAI,EAAE,CAAC;MAEjC,MAAM;QAAET,IAAI,EAAEY,KAAK;QAAEX,KAAK,EAAEY;MAAK,CAAC,GAAG,MAAMvC,QAAQ,CAChD4B,IAAI,CAAC,gBAAgB,CAAC,CACtBC,MAAM,CAAC,GAAG,CAAC,CACXQ,EAAE,CAAC,aAAa,EAAEH,UAAU,CAAC,CAC7BJ,KAAK,CAAC,WAAW,EAAE;QAAEC,SAAS,EAAE;MAAK,CAAC,CAAC;MAC1C,IAAI,CAACQ,IAAI,EAAErB,QAAQ,CAACoB,KAAK,IAAI,EAAE,CAAC;IAClC,CAAC,CAAC,OAAOE,CAAC,EAAE;MACVC,OAAO,CAACd,KAAK,CAACa,CAAC,CAAC;MAChBxB,SAAS,CAAC,EAAE,CAAC;MACbE,QAAQ,CAAC,EAAE,CAAC;IACd,CAAC,SAAS;MACRE,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAEDtB,SAAS,CAAC,MAAM;IACd2B,aAAa,CAAC,CAAC;EACjB,CAAC,EAAE,EAAE,CAAC;EAEN3B,SAAS,CAAC,MAAM;IACd,IAAIe,gBAAgB,EAAEoB,QAAQ,CAACpB,gBAAgB,CAAC6B,EAAE,CAAC;EACrD,CAAC,EAAE,CAAC7B,gBAAgB,CAAC,CAAC;EAEtB,MAAM8B,YAAY,GAAGA,CAACT,UAAU,EAAEU,WAAW,KAAK;IAChD,MAAMC,GAAG,GAAG,mBAAmBX,UAAU,UAAUU,WAAW,EAAE;IAChE,IAAI;MAAEE,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAGH,GAAG;IAAE,CAAC,CAAC,OAAOL,CAAC,EAAE;MAAEC,OAAO,CAACQ,GAAG,CAAC,UAAU,EAAEJ,GAAG,CAAC;IAAE;EAChF,CAAC;EAED,MAAMK,eAAe,GAAIC,KAAK,IAAK;IACjC3B,eAAe,CAAC2B,KAAK,CAAC;IACtB7B,iBAAiB,CAAC,IAAI,CAAC;EACzB,CAAC;EAED,MAAM8B,eAAe,GAAG,MAAOC,OAAO,IAAK;IACzC,IAAI;MACF,MAAMX,EAAE,GAAGW,OAAO,CAACX,EAAE;MACrB,IAAI,CAACA,EAAE,EAAE,MAAM,IAAIY,KAAK,CAAC,kBAAkB,CAAC;;MAE5C;MACA,MAAMC,UAAU,GAAG;QAAEC,MAAM,EAAEH,OAAO,CAACG;MAAO,CAAC;MAC7C,IAAIH,OAAO,CAACI,WAAW,KAAK,IAAI,IAAIJ,OAAO,CAACI,WAAW,KAAKC,SAAS,EAAEH,UAAU,CAACE,WAAW,GAAGJ,OAAO,CAACI,WAAW;MAEnH,IAAI/B,IAAI,EAAEC,KAAK;MACf,CAAC;QAAED,IAAI;QAAEC;MAAM,CAAC,GAAG,MAAM3B,QAAQ,CAAC4B,IAAI,CAAC,QAAQ,CAAC,CAAC+B,MAAM,CAACJ,UAAU,CAAC,CAAClB,EAAE,CAAC,IAAI,EAAEK,EAAE,CAAC;MAEhF,IAAIf,KAAK,EAAE;QACT,MAAMiC,GAAG,GAAG,CAACjC,KAAK,CAACkC,OAAO,IAAI,EAAE,EAAEC,WAAW,CAAC,CAAC;QAC/C,IAAIP,UAAU,CAACE,WAAW,KAAKG,GAAG,CAACG,QAAQ,CAAC,sBAAsB,CAAC,IAAIH,GAAG,CAACG,QAAQ,CAAC,kCAAkC,CAAC,IAAIH,GAAG,CAACG,QAAQ,CAAC,gBAAgB,CAAC,CAAC,EAAE;UAC1J;UACA,OAAOR,UAAU,CAACE,WAAW;UAC7B,CAAC;YAAE/B,IAAI;YAAEC;UAAM,CAAC,GAAG,MAAM3B,QAAQ,CAAC4B,IAAI,CAAC,QAAQ,CAAC,CAAC+B,MAAM,CAACJ,UAAU,CAAC,CAAClB,EAAE,CAAC,IAAI,EAAEK,EAAE,CAAC;QAClF;MACF;MAEA,IAAIf,KAAK,EAAE,MAAMA,KAAK;;MAEtB;MACA,IAAI0B,OAAO,CAACW,IAAI,EAAE;QAChB,MAAMC,cAAc,GAAG,CAAC,YAAY,EAAE,MAAM,CAAC;QAC7C,IAAIC,WAAW,GAAG,KAAK;QACvB,KAAK,MAAMC,GAAG,IAAIF,cAAc,EAAE;UAChC,MAAMG,EAAE,GAAG,CAAC,CAAC;UACbA,EAAE,CAACD,GAAG,CAAC,GAAGd,OAAO,CAACW,IAAI;UACtB,MAAMK,GAAG,GAAG,MAAMrE,QAAQ,CAAC4B,IAAI,CAAC,QAAQ,CAAC,CAAC+B,MAAM,CAACS,EAAE,CAAC,CAAC/B,EAAE,CAAC,IAAI,EAAEK,EAAE,CAAC;UACjE,IAAI,CAAC2B,GAAG,CAAC1C,KAAK,EAAE;YACduC,WAAW,GAAG,IAAI;YAClB;UACF;UACA,MAAMI,EAAE,GAAG,CAACD,GAAG,CAAC1C,KAAK,CAACkC,OAAO,IAAI,EAAE,EAAEC,WAAW,CAAC,CAAC;UAClD,IAAIQ,EAAE,CAACP,QAAQ,CAAC,WAAWI,GAAG,GAAG,CAAC,IAAIG,EAAE,CAACP,QAAQ,CAAC,uBAAuBI,GAAG,GAAG,CAAC,IAAIG,EAAE,CAACP,QAAQ,CAAC,gBAAgB,CAAC,EAAE;YACjH;YACA;UACF;UACA;UACA,MAAMM,GAAG,CAAC1C,KAAK;QACjB;QACA,IAAI,CAACuC,WAAW,EAAE;UAChBzB,OAAO,CAAC8B,IAAI,CAAC,qEAAqE,CAAC;QACrF;MACF;MAEAjD,iBAAiB,CAAC,KAAK,CAAC;MACxBW,QAAQ,CAACpB,gBAAgB,CAAC6B,EAAE,CAAC;IAC/B,CAAC,CAAC,OAAOF,CAAC,EAAE;MACVC,OAAO,CAACd,KAAK,CAAC,qBAAqB,EAAEa,CAAC,CAAC;MACvCM,MAAM,CAAC0B,KAAK,CAAC,4BAA4B,IAAIhC,CAAC,CAACqB,OAAO,IAAIrB,CAAC,CAAC,CAAC;IAC/D;EACF,CAAC;EAED,oBACEhC,OAAA;IAAKiE,SAAS,EAAC,KAAK;IAAAC,QAAA,gBAClBlE,OAAA;MAAKiE,SAAS,EAAC,wCAAwC;MAAAC,QAAA,eACrDlE,OAAA;QAAAkE,QAAA,gBACElE,OAAA;UAAIiE,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAAa;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACrDtE,OAAA;UAAGiE,SAAS,EAAC,uBAAuB;UAAAC,QAAA,EAAC;QAA4B;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAClE;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eACNtE,OAAA;MAAKiE,SAAS,EAAC,MAAM;MAAAC,QAAA,gBACnBlE,OAAA;QAAKiE,SAAS,EAAC,0BAA0B;QAAAC,QAAA,EACtC/D,SAAS,CAACoE,GAAG,CAAEC,CAAC,iBACfxE,OAAA;UACEyE,OAAO,EAAEA,CAAA,KAAMnE,mBAAmB,CAACkE,CAAC,CAAE;UACtCP,SAAS,EAAE,6EAA6E5D,gBAAgB,IAAIA,gBAAgB,CAAC6B,EAAE,KAAKsC,CAAC,CAACtC,EAAE,GAAG,mCAAmC,GAAG,aAAa,EAAG;UAAAgC,QAAA,gBACjMlE,OAAA;YAAKiE,SAAS,EAAC,uBAAuB;YAAAC,QAAA,GAAC,2BAAK,EAACM,CAAC,CAACE,IAAI;UAAA;YAAAP,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC1DtE,OAAA;YAAKiE,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAEM,CAAC,CAAChB;UAAI;YAAAW,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC7CtE,OAAA;YAAKiE,SAAS,EAAC,6CAA6C;YAAAC,QAAA,EACzDM,CAAC,CAACxB,MAAM,KAAK,aAAa,gBACzBhD,OAAA;cAAMiE,SAAS,EAAC,iDAAiD;cAAAC,QAAA,EAAC;YAAK;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,GAC5EE,CAAC,CAACxB,MAAM,KAAK,UAAU,gBACzBhD,OAAA;cAAMiE,SAAS,EAAC,6CAA6C;cAAAC,QAAA,EAAC;YAAO;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,gBAE5EtE,OAAA;cAAMiE,SAAS,EAAC,2CAA2C;cAAAC,QAAA,EAAC;YAAG;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM;UACtE;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC;QAAA,GAbKE,CAAC,CAACtC,EAAE;UAAAiC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAcT,CACT;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eAGNtE,OAAA;QAAKiE,SAAS,EAAC,4CAA4C;QAAAC,QAAA,EACxD,CAAC,MAAM;UACN;UACA,MAAMS,MAAM,GAAGpE,MAAM,CAACqE,MAAM,CAAC,CAACC,GAAG,EAAEC,CAAC,KAAK;YACvCD,GAAG,CAACE,KAAK,IAAIC,MAAM,CAACF,CAAC,CAACG,WAAW,IAAI,CAAC,CAAC;YACvCJ,GAAG,CAACK,SAAS,IAAIF,MAAM,CAACF,CAAC,CAACK,eAAe,IAAI,CAAC,CAAC;YAC/CN,GAAG,CAACO,QAAQ,IAAIJ,MAAM,CAACF,CAAC,CAACO,cAAc,IAAI,CAAC,CAAC;YAC7CR,GAAG,CAACS,QAAQ,IAAIN,MAAM,CAACF,CAAC,CAACS,cAAc,IAAI,CAAC,CAAC;YAC7CV,GAAG,CAACW,WAAW,IAAIR,MAAM,CAACF,CAAC,CAACW,iBAAiB,IAAI,CAAC,CAAC;YACnD,OAAOZ,GAAG;UACZ,CAAC,EAAE;YAAEE,KAAK,EAAE,CAAC;YAAEG,SAAS,EAAE,CAAC;YAAEE,QAAQ,EAAE,CAAC;YAAEE,QAAQ,EAAE,CAAC;YAAEE,WAAW,EAAE;UAAE,CAAC,CAAC;UACxE,OAAO,CACL;YAAEE,GAAG,EAAE,OAAO;YAAEC,KAAK,EAAE,cAAc;YAAEC,KAAK,EAAEjB,MAAM,CAACI,KAAK;YAAEc,KAAK,EAAE;UAAW,CAAC,EAC/E;YAAEH,GAAG,EAAE,WAAW;YAAEC,KAAK,EAAE,OAAO;YAAEC,KAAK,EAAEjB,MAAM,CAACO,SAAS;YAAEW,KAAK,EAAE;UAAc,CAAC,EACnF;YAAEH,GAAG,EAAE,UAAU;YAAEC,KAAK,EAAE,QAAQ;YAAEC,KAAK,EAAEjB,MAAM,CAACW,QAAQ;YAAEO,KAAK,EAAE;UAAe,CAAC,EACnF;YAAEH,GAAG,EAAE,UAAU;YAAEC,KAAK,EAAE,QAAQ;YAAEC,KAAK,EAAEjB,MAAM,CAACS,QAAQ;YAAES,KAAK,EAAE;UAAY,CAAC,EAChF;YAAEH,GAAG,EAAE,aAAa;YAAEC,KAAK,EAAE,OAAO;YAAEC,KAAK,EAAEjB,MAAM,CAACa,WAAW;YAAEK,KAAK,EAAE;UAAa,CAAC,CACvF,CAACtB,GAAG,CAACuB,GAAG,iBACP9F,OAAA;YAAmBiE,SAAS,EAAE,sBAAsB6B,GAAG,CAACD,KAAK,EAAG;YAAA3B,QAAA,gBAC9DlE,OAAA;cAAKiE,SAAS,EAAC,uBAAuB;cAAAC,QAAA,EAAE4B,GAAG,CAACH;YAAK;cAAAxB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eACxDtE,OAAA;cAAKiE,SAAS,EAAC,uBAAuB;cAAAC,QAAA,EAAE4B,GAAG,CAACF;YAAK;cAAAzB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA,GAFhDwB,GAAG,CAACJ,GAAG;YAAAvB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAGZ,CACN,CAAC;QACJ,CAAC,EAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,EAEL3D,OAAO,gBACNX,OAAA;MAAAkE,QAAA,EAAK;IAAQ;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,gBAEnBtE,OAAA;MAAKiE,SAAS,EAAC,WAAW;MAAAC,QAAA,GACvB3D,MAAM,CAACiB,MAAM,KAAK,CAAC,gBAClBxB,OAAA;QAAKiE,SAAS,EAAC,6BAA6B;QAAAC,QAAA,EAAC;MAAmC;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,GAEtF/D,MAAM,CAACgE,GAAG,CAAEO,CAAC,iBACX9E,OAAA;QAA0BiE,SAAS,EAAC,yBAAyB;QAAAC,QAAA,gBAC3DlE,OAAA;UACEiE,SAAS,EAAC,uCAAuC;UACjD8B,KAAK,EACHjB,CAAC,CAAC9B,MAAM,KAAK,aAAa,GACtB;YAAEgD,UAAU,EAAE;UAAyC,CAAC,GACxDlB,CAAC,CAAC9B,MAAM,KAAK,UAAU,GACvB;YAAEgD,UAAU,EAAE;UAAyC,CAAC,GACxD;YAAEA,UAAU,EAAE;UAAyC,CAC5D;UAAA9B,QAAA,gBAEDlE,OAAA;YAAKiE,SAAS,EAAC,YAAY;YAAAC,QAAA,gBACzBlE,OAAA;cAAKiE,SAAS,EAAC,uBAAuB;cAAAC,QAAA,GAAC,uCAAO,EAACY,CAAC,CAACmB,YAAY;YAAA;cAAA9B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eACpEtE,OAAA;cAAKiE,SAAS,EAAC,oBAAoB;cAAAC,QAAA,GAAEY,CAAC,CAACG,WAAW,EAAC,6CAAU,EAACH,CAAC,CAACK,eAAe,EAAC,uCAAS,EAACL,CAAC,CAACO,cAAc,EAAC,uCAAO;YAAA;cAAAlB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACrH,CAAC,eACNtE,OAAA;YAAKiE,SAAS,EAAC,4CAA4C;YAAAC,QAAA,gBACzDlE,OAAA;cAAQyE,OAAO,EAAEA,CAAA,KAAM/B,eAAe,CAACoC,CAAC,CAAE;cAACb,SAAS,EAAC,0CAA0C;cAAAC,QAAA,EAAC;YAAY;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACrHtE,OAAA;cAAAkE,QAAA,EAAM7D,gBAAgB,IAAIA,gBAAgB,CAACmD;YAAI;cAAAW,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnD,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAENtE,OAAA;UAAKiE,SAAS,EAAC,KAAK;UAAAC,QAAA,eAClBlE,OAAA;YAAKiE,SAAS,EAAC,4BAA4B;YAAAC,QAAA,EACxCzD,KAAK,CAACyF,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,QAAQ,KAAKtB,CAAC,CAACsB,QAAQ,CAAC,CAAC5E,MAAM,KAAK,CAAC,gBACxDxB,OAAA;cAAKiE,SAAS,EAAC,yBAAyB;cAAAC,QAAA,gBACtClE,OAAA;gBAAKiE,SAAS,EAAC,oBAAoB;gBAAAC,QAAA,EAAC;cAAyB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eACnEtE,OAAA;gBAAQyE,OAAO,EAAEA,CAAA,KAAMtC,YAAY,CAAC2C,CAAC,CAACuB,WAAW,EAAEvB,CAAC,CAACmB,YAAY,CAAE;gBAAChC,SAAS,EAAC,0CAA0C;gBAAAC,QAAA,EAAC;cAAS;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACxI,CAAC,GAEN7D,KAAK,CAACyF,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,QAAQ,KAAKtB,CAAC,CAACsB,QAAQ,CAAC,CAAC7B,GAAG,CAAE4B,CAAC,iBACjDnG,OAAA,CAACP,QAAQ;cAAY6G,IAAI,EAAEH;YAAE,GAAdA,CAAC,CAACjE,EAAE;cAAAiC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAY,CAChC;UACF;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA,GAlCMQ,CAAC,CAACsB,QAAQ;QAAAjC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAmCf,CACV,CACF,eAEDtE,OAAA;QAAKiE,SAAS,EAAC,6BAA6B;QAAAC,QAAA,gBAC1ClE,OAAA;UAAIiE,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAAkB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC1DtE,OAAA;UAAKiE,SAAS,EAAC,eAAe;UAAAC,QAAA,eAC5BlE,OAAA;YAAOiE,SAAS,EAAC,gBAAgB;YAAAC,QAAA,gBAC/BlE,OAAA;cAAAkE,QAAA,eACElE,OAAA;gBAAIiE,SAAS,EAAC,yBAAyB;gBAAAC,QAAA,gBACrClE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,EAAC;gBAAM;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC/BtE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,EAAC;gBAAS;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAClCtE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,EAAC;gBAAK;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC9BtE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,EAAC;gBAAM;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC/BtE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,EAAC;gBAAM;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC/BtE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,EAAC;gBAAK;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC9BtE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,EAAC;gBAAY;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACnC;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC,eACRtE,OAAA;cAAAkE,QAAA,EACG3D,MAAM,CAACgE,GAAG,CAAEO,CAAC,iBACZ9E,OAAA;gBAAqBiE,SAAS,EAAC,UAAU;gBAAAC,QAAA,gBACvClE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,GAAC,uCAAO,EAACY,CAAC,CAACmB,YAAY;gBAAA;kBAAA9B,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAChDtE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,EAAEY,CAAC,CAACG;gBAAW;kBAAAd,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eACxCtE,OAAA;kBAAIiE,SAAS,EAAC,oBAAoB;kBAAAC,QAAA,EAAEY,CAAC,CAACK;gBAAe;kBAAAhB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC3DtE,OAAA;kBAAIiE,SAAS,EAAC,kBAAkB;kBAAAC,QAAA,EAAEY,CAAC,CAACO;gBAAc;kBAAAlB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eACxDtE,OAAA;kBAAIiE,SAAS,EAAC,qBAAqB;kBAAAC,QAAA,EAAEY,CAAC,CAACS;gBAAc;kBAAApB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC3DtE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,EAAEY,CAAC,CAACW;gBAAiB;kBAAAtB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC,eAC9CtE,OAAA;kBAAIiE,SAAS,EAAC,KAAK;kBAAAC,QAAA,GAAEqC,IAAI,CAACC,KAAK,CAAC,CAAC1B,CAAC,CAAC2B,cAAc,IAAI,CAAC,IAAI,GAAG,CAAC,EAAC,GAAC;gBAAA;kBAAAtC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC;cAAA,GAP9DQ,CAAC,CAACsB,QAAQ;gBAAAjC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAQf,CACL;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACG,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAEH,CACN,EAEAzD,cAAc,iBACbb,OAAA,CAACN,UAAU;MACTgH,WAAW,EAAE3F,YAAa;MAC1B4F,OAAO,EAAEA,CAAA,KAAM7F,iBAAiB,CAAC,KAAK,CAAE;MACxC8F,MAAM,EAAEhE;IAAgB;MAAAuB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACzB,CACF;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV;AAACpE,EAAA,CAxQuBD,MAAM;AAAA4G,EAAA,GAAN5G,MAAM;AAAA,IAAA4G,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}